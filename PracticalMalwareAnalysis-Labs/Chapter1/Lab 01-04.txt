Lab01-04.exe
    # Virustotal
        60/70
        SHA-256: 0fa1498340fca6c562cfa389ad3e93395f44c72fd128d7ba08579a69aaf3b126

    # PEid
        Microsoft Visual C++ 6.0

    # PEview
        TimeStamp (IMAGE_FILE_HEADER): 2019/08/30 Fri 22:26:59 UTC                  // Fake Time due to the date modified is 2011/07/05 in Windows Explorer. 
        Subsystem (IMAGE_OPTIONAL_HEADER): IMAGE_SUBSYSTEM_WINDOWS_GUI (Graphic)
        Sections (Virtual Size / Size of Raw Data) -> No Packed
            .text: 720/1000
            .rdata: 3D2/1000
            .data: 14C/1000
            .rsrc: 4060/5000
    
    # Dependency Walker
        KERNEL32.DLL
            CloseHandle
            CreateFileA                 // Create File after loading data
            CreateRemoteThread
            FindResourceA               // Load data from .rsrc
            GetCurrentProcess
            GetModuleHandleA
            GetProcAddress
            GetTempPathA
            GetWindowDirectoryA         // Get the Windows system directory %windir%
            LoadLibraryA
            LoadResource                // Load data from .rsrc
            MoveFileA                   // Move file after loading data
            OpenProcess                 // Start process
            SizeofResource              // Load data from .rsrc
            WinExec                     // Execute system command
            WriteFile                   // Write file to the disk
        ADVAPI32.DLL
            AjustTokenPrivileges
            LookupPrivilegeValueA
            OpenProcessToken
        MSVCRT.DLL

    # strings.exe (Only part of the results)
        winlogon.exe
        <not real>
        SeDebugPrivilege
        sfc_os.dll
        \system32\wupdmgr.exe
        %s%s
        BIN
        #101
        EnumProcessModules
        psapi.dll
        GetModuleBaseNameA
        psapi.dll
        EnumProcesses
        psapi.dll
        \system32\wupdmgr.exe                   // No such file in original Windows system
        %s%s
        \winup.exe                              // No such file in original Windows system
        %s%s
        BIN
        WinExec
        GetTempPathA
        KERNEL32.dll
        URLDownloadToFileA
        urlmon.dll
        \winup.exe                              // No such file in original Windows system
        %s%s
        \system32\wupdmgrd.exe                  // No such file in original Windows system
        %s%s
        http://www.practicalmalwareanalysis.com/updater.exe     // Additional malicious code

    # Resource Hacker
        Found the .rsrc section has an additional PE file.
        "!This program cannot be run in DOS mode."
        Save to BIN file (BIN101.bin): Action > Save Resource to a BIN file.

BIN101.bin
    # Virustotal
        54/69
        md5: 819b2db1876d85846811799664d512b2f1af13e329f5debe60926c3b03424745

    # PEid
        Microsoft Visual C++ 6.0

    # PEview
        TimeStamp (IMAGE_FILE_HEADER): 2011/02/27 Sun 00:16:59 UTC
        Subsystem (IMAGE_OPTIONAL_HEADER): IMAGE_SUBSYSTEM_WINDOWS_GUI (Graphic)
        Sections (Virtual Size / Size of Raw Data) -> No Packed
            .text: 27C/1000
            .rdata: 242/1000
            .data: 9C/1000
    
    # Dependency Walker
        KERNEL32.DLL
            GetTempPathA
            GetWindowDirectoryA
            WinExec
        URLMON.DLL
            URLDownloadToFileA              // Download files from Internet
        MSVCRT.DLL

    # strings.exe (Only part of the results)
        \winup.exe
        %s%s
        \system32\wupdmgrd.exe
        %s%s
        http://www.practicalmalwareanalysis.com/updater.exe

Analysis
    From the Lab01-04.exe, we can know that the malware may download another data file from http://www.practicalmalwareanalysis.com/updater.exe. And it may place the file at the location of \system32\wupdmgrd.exe and use WinExec to start it quietly. However, none of network function has been found in the file. Using Resource Hacker we can get the URLDownloadToFile function in the import section.
    
