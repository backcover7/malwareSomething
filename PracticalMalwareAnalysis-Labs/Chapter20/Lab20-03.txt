Lab20-02.exe
    PE Analysis
        # Virustotal
            23/68
            SHA-256: d9ea48b83700f61cc63b43ffcc25e16fe71ec974f74b51bae238d56533cd132c

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-11-13 18:03:22

            Subsystem: Windows CUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	57581	61440	6.35	1d691246a1bbb5f04f6f0b1f6a2ff6ae
                .rdata	65536	10582	12288	3.67	e73d5b6d0ee352c2fc70cb376b41fc21
                .data	77824	11656	8192	2.96	580fa3c8f642c11f1aec319b9d9e9af9

        Imports
            ADVAPI32.dll
                GetUserNameA
            KERNEL32.dll
                GetLastError
                HeapFree
                GetStdHandle
                LCMapStringW
                SetHandleCount
                GetOEMCP
                LCMapStringA
                HeapDestroy
                HeapAlloc
                IsBadWritePtr
                FlushFileBuffers
                GetEnvironmentStringsW
                GetVersionExA
                LoadLibraryA
                RtlUnwind
                GetModuleFileNameA
                FreeEnvironmentStringsA
                GetCurrentProcess
                GetEnvironmentStrings
                GetFileSize
                UnhandledExceptionFilter
                WideCharToMultiByte
                GetSystemDefaultLCID
                MultiByteToWideChar
                HeapSize
                FreeEnvironmentStringsW
                GetCommandLineA
                GetProcAddress
                GetFileType
                SetStdHandle
                RaiseException
                GetCPInfo
                GetStringTypeA
                SetFilePointer
                ReadFile
                CreateFileA
                WriteFile
                GetStartupInfoA
                CloseHandle
                GetComputerNameA
                GetACP
                HeapReAlloc
                GetStringTypeW
                TerminateProcess
                CreateProcessA
                SetUnhandledExceptionFilter
                HeapCreate
                VirtualFree
                Sleep
                IsBadReadPtr
                IsBadCodePtr
                ExitProcess
                GetVersion
                VirtualAlloc
            WS2_32.dll
                socket
                closesocket
                inet_addr
                send
                WSACleanup
                WSAStartup
                gethostbyname
                connect
                htons
                recv
                WSAGetLastError

        # strings.exe
            PLMOKNIJBUHVYGTFCRDXESZWAQzaqxswcdevfrbgtnhymjukilop
            ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
            .?AVexception@@
            .?AVruntime_error@std@@
            .?AUB64Error@@
            .?AUB64EncodeError@@
            Encoding Args Error
            /srv.html
            /put.html
            /get.html
            /response.html
            /info.html
            /index.html
            .?AUBackdoorClientParentError@@
            .?AUBackdoorClientError@@
            Beacon response Error
            Caught exception during pollstatus: %s
            Polling error
            %s?id=%s
            .?AUCmdParseError@@
            Arg parsing error
            %s %s "%s"
            Error uploading file
            Error downloading file
            user=%s, host=%s, Major Version=%d, Minor Version=%d, Locale=%d
            Error conducting machine survey
            Create Process Failed
            ;computer=
            volsn=
            victim;
            Failed to gather victim information
            .?AUReadConfigError@@
            Config error
            config.dat
            .?AUMaskConfigError@@
            Caught exception in main: %s
            .?AUConnectError@@
            .?AUNetworkError@@
            .?AUSocketError@@
            Socket Connection Error
            Internet Explorer 10.0
            .?AUResolveHostError@@
            Host lookup failed.
            .?AUSendError@@
            .?AUNotConnectedError@@
            Send Data Error
            .?AUHttpResponseError@@
            Error reading response
            Content-Length:
            Error reading response
            HTTP/
            .?AUGetError@@
            Error sending Http get
            GET %s HTTP/1.1
            HOST: %s
            User-Agent: %s
            Accept: text/html
            Accept-Language: en-uk,en
            Accept-Charset: utf-8
            Connection: close
            data=
            .?AUPostError@@
            POST %s HTTP/1.1
            HOST: %s
            User-Agent: %s
            Content-Length: %d
            Content-Type: application/x-www-form-urlencoded
            Error sending Http post
            .?AUWsaStartupError@@
            Failed to initialize WSA
            .?AVios_base@std@@
            .?AV?$basic_ios@DU?$char_traits@D@std@@@std@@
            .?AV?$basic_istream@DU?$char_traits@D@std@@@std@@
            .?AV?$basic_ostream@DU?$char_traits@D@std@@@std@@
            .?AV?$basic_streambuf@DU?$char_traits@D@std@@@std@@
            .?AV?$basic_filebuf@DU?$char_traits@D@std@@@std@@
            .?AV?$basic_ios@GU?$char_traits@G@std@@@std@@
            .?AV?$basic_istream@GU?$char_traits@G@std@@@std@@
            .?AV?$basic_ostream@GU?$char_traits@G@std@@@std@@
            .?AV?$basic_filebuf@GU?$char_traits@G@std@@@std@@
            .?AV?$basic_streambuf@GU?$char_traits@G@std@@@std@@
            .?AVlogic_error@std@@
            .?AVlength_error@std@@
            .?AVout_of_range@std@@
            .?AVfailure@ios_base@std@@
            .?AVfacet@locale@std@@
            .?AV_Locimp@locale@std@@
            .?AVtype_info@@
    
    Dynamic Analysis
        NULL

        # IDA Pro
            main
                .text:00403C90                 call    sub_403BE0
            
            void sub_403BE0()
            {
            v0 = 0;
            v5 = &v3;
            v6 = 0;
            v1 = operator new(0x30u);
            v4 = v1;
            LOBYTE(v6) = 1;
            if ( v1 )
                v2 = config_data_process(v1, FileName);
            else
                v2 = 0;
            LOBYTE(v6) = 0;
            sub_401F80(v2);         // message initialize
            while ( 1 )
            {
                Sleep(500 * *(*v2 + 400));
                sub_402410(v2);     // 6 cases to c&c
                ++v0;
            }
            }
            
