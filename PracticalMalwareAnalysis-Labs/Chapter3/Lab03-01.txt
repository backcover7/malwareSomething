Lab03-01.exe
    PE Analysis
        # Virustotal
            69/71
            SHA-256: eb84360ca4e33b8bb60df47ab5ce962501ef3420bc7aab90655fd507d2ffcedd
            md5: D537ACB8F56A1CE206BC35CF8FF959C0

        # PEid
            PEncrypt 3.1 Final -> junkcode ??

        # PEview
            TimeStamp (IMAGE_FILE_HEADER): 2008/01/06 Sun 14:51:31 UTC
            Subsystem (IMAGE_OPTIONAL_HEADER): IMAGE_SUBSYSTEM_WINDOWS_GUI (Graphic)
            Sections (Virtual Size / Size of Raw Data) -> No Packed
                .text: 68/200
                .data: 168F/1800
        
        # Dependency Walker
            KERNEL32.DLL
                ExitProcess

        # strings.exe (Only part of the results)
            SOFTWARE\Classes\http\shell\open\commandV
            Software\Microsoft\Active Setup\Installed Components\
            test
            www.practicalmalwareanalysis.com
            admin
            VideoDriver
            WinVMX32-
            vmx32to64.exe
            SOFTWARE\Microsoft\Windows\CurrentVersion\Run
            SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders

    Network Analysis
        # RegShot (Part of results)
            ----------------------------------
            Values added: 35
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VideoDriver:  43 00 3A 00 5C 00 57 00 49 00 4E 00 44 00 4F 00 57 00 53 00 5C 00 73 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 5C 00 76 00 6D 00 78 00 33 00 32 00 74 00 6F 00 36 00 34 00 2E 00 65 00 78 00 65 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

            ----------------------------------
            Values modified: 5
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed:  04 F7 D7 3C DD DC AE F0 2A 4F A5 03 63 3E CF 69 40 E8 C9 65 7A D4 C3 45 05 74 99 47 65 94 61 6D 19 EA 08 B0 C8 58 B0 67 91 F9 C9 7B E5 34 07 D9 49 A5 D2 44 4C 01 DC 96 76 2E 5C 79 2A FA AF 2B FD C2 C2 6C 59 C2 3F 17 13 2A DB 98 BF 17 DD 30
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed:  46 09 0A 7A E4 5F 59 D4 0E 69 B8 C3 34 1F C5 E1 20 8E E2 62 40 FF 9A 39 D4 AB 8C 94 35 96 E4 19 79 5C 53 AA A1 75 AE F9 4F C4 E6 94 66 79 EA A0 C3 EB 2B 69 E6 FE 7B 20 ED 61 98 AF E4 9E 15 17 DF 0D 92 92 56 C3 A3 CB C7 03 8E E4 CB 9D BF DA

        # procmon
            Filter
                Process Name is Lab03-01.exe Include
                Operation is RegSetValue Include
                Operation is WriteFile Include

            Result
                4:16:16.3198144 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 76 F0 3F 5D BF 92 99 24 1A D9 23 3B F1 EF 09 FB
                4:16:16.3435677 PM	Lab03-01.exe	3620	WriteFile	C:\WINDOWS\system32\vmx32to64.exe	SUCCESS	Offset: 0, Length: 7,168
                    md5: D537ACB8F56A1CE206BC35CF8FF959C0; THE SAME AS Lab03-01.exe             // Rename itself
                4:16:16.3441225 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VideoDriver	SUCCESS	Type: REG_SZ, Length: 510, Data: C:\WINDOWS\system32\vmx32to64.exe
                    Data: C:\WINDOWS\system32\vmx32to64.exe                                     // Move to system directory
                4:16:16.3847145 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: DF F1 33 E7 31 97 56 91 60 4A B8 D7 45 51 8A 03
                4:16:16.3848500 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 3D 0D 63 C4 3F 8F B7 37 5A E9 6C B7 B4 F5 E9 A9
                4:16:16.3849576 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: BC BA D8 DB 7D C2 FF F9 80 F8 D4 6D 5F ED F0 60
                4:16:16.3850654 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: A8 30 15 CA 12 FF D2 5B AF B6 34 C6 0D 4D E7 25
                4:16:16.3851721 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 41 F2 13 CC E0 08 66 36 84 72 C7 DA 5B 75 15 88
                4:16:16.3852786 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 76 7E 85 37 84 EE 36 46 61 6D B3 F9 65 1A 82 48
                4:16:16.3853853 PM	Lab03-01.exe	3620	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 5E B1 0C A7 AD EB 7B D1 2F 20 E8 92 DB 37 E9 59


        # procexp (View > Lower Pane View > DLLS / Handles)
            DLL
                dnsapi.dll      // Network
                ws2_32.dll
                wshtcpip.dll
            Handle
                Mutant  \BaseNaemObjects\WinVMX32

        # ApateDNS
            DNS Reply IP: 127.0.0.1
            www.practicalmalwareanalysis.com
                67 54 01 00 00 01 00 00  00 00 00 00 03 77 77 77            gT···········www
                18 70 72 61 63 74 69 63  61 6C 6D 61 6C 77 61 72            ·practicalmalwar
                65 61 6E 61 6C 79 73 69  73 03 63 6F 6D 00 00 01            eanalysis·com···
                00 01 00 00                                                 ····            

        # Netcat
            C:\Documents and Settings\practice\Desktop>nc.exe -lvvp 443
            listening on [any] 443 ...
            DNS fwd/rev mismatch: localhost != malware
            connect to [127.0.0.1] from localhost [127.0.0.1] 1037
            ╒$°I9Hì⌠B╙µfX^$ª▄ú▒ì§♂Å▐è±1╨*é\cδ↓uq(ù◄(H♂ⁿá♥R╘6úG93╪╟"bwπY┴∞åÇ§^2╨GXçÅα}⌡Æ3$→ú≤
            )∩§╘N₧ô¼á┼FM╛┴╨↑↓
            îⁿφd0▌eú~W=☺╧╡/±⌐U5║ow_¶!ú⌡É►^è)»┌Θ°τ£-±$σ83♦ΦJ¬└Ñöiπß|Æùó
            §%αR‼6║◄à─!╞ÿå*╨h]▄æs^í∩⌐╥Ç¶├╥1µ`┴▄vg≤┴Φ→NT>┘→↓╧]╚╞√ïπ
        
        # Wireshark
            DNS
                query: practicalmalwareanalysis.com
                response: CNAME practicalmalwareanalysis.com
            SSl:
                0000   71 c6 ae a6 c7 3e 33 ef eb 53 91 91 18 f7 40 fc  q....>3..S....@.
                0010   b2 73 e2 ae 59 30 07 86 9e 37 77 68 55 35 f9 99  .s..Y0...7whU5..
                0020   77 8a 94 8f cb 67 f0 ba 5f 75 c8 e7 9d fd 09 0c  w....g.._u......
                0030   ad d3 d6 88 e0 18 e1 cc 05 61 ff 9d a1 73 b2 b0  .........a...s..
                0040   47 52 26 8a 9e 16 57 e5 3c 2d 76 bf 47 fe aa f3  GR&...W.<-v.G...
                0050   d5 1f f3 29 46 e0 66 1b b5 37 90 9f 65 fd ad ce  ...)F.f..7..e...
                0060   69 39 1f df ff c4 6b 94 7b 30 16 16 0f 1b d3 42  i9....k.{0.....B
                0070   cd f1 c6 cd 6f d1 18 be bd 9d 87 0d 44 b1 b8 4f  ....o.......D..O
                0080   e0 67 18 af dc 4a 08 99 97 0d 2c f0 7b 96 8c d1  .g...J....,.{...
                0090   56 1e 39 ad d1 de 82 29 c9 37 db bf 4f a4 0b 5d  V.9....).7..O..]
                00a0   f0 a9 36 c8 8e 63 e6 e6 a3 80 85 2c 59 b4 4c f3  ..6..c.....,Y.L.
                00b0   eb 14 cc 7c ac 77 1e 8a d6 23 3a 49 31 77 82 b3  ...|.w...#:I1w..
                00c0   0c 65 9e cb c8 e1 f3 d5 f8 69 e3 46 ef ee c3 9f  .e.......i.F....
                00d0   ce a2 a5 d8 91 63 fe 18 7d cd 67 02 2f 5d d5 ee  .....c..}.g./]..
                00e0   bc 4e f8 57 d7 1a e6 6a 76 02 af 59 c2 30 2a 8b  .N.W...jv..Y.0*.
                00f0   66 fc fc 60 a1 5a 0f 4c e4 7a 3d 71 da ee f3 ba  f..`.Z.L.z=q....
    
Analysis
    The file Lab03-01.exe firstly copy itself and write it under the /windows/system/ directory. Also it acess the www.practicalmalwareanalysis.com and send SSL data to the site.

Troubleshooting
    Lab03-01.exe could be run only in the env of XP_x86.
    In XP_86, we need to install .net framework 2.0 to run the ApateDNS.
