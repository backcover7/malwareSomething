Lab16-03.exe
    PE Analysis
        # Virustotal
            4/72
            SHA-256: f36de55cf09c24045f241d50519a2ff1e5578336d0e8426eeabe5b39162d9006

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-10-22 19:36:11

            Subsystem: Windows CUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	15310	16384	6.37	5c7b27b4c9af5e51fde0735865d98bbf
                .rdata	20480	2268	4096	3.53	a6bd8c58f5d355c89a78f6583a6913f0
                .data	24576	10780	12288	0.42	45758e90f16d0246240ff4760b88f5dc

            IMPORT
                KERNEL32.dll
                    HeapFree
                    GetStdHandle
                    LCMapStringW
                    SetHandleCount
                    WaitForSingleObject
                    GetOEMCP
                    LCMapStringA
                    HeapDestroy
                    ExitProcess
                    GetEnvironmentStringsW
                    GetVersionExA
                    GetModuleFileNameA
                    RtlUnwind
                    LoadLibraryA
                    GetShortPathNameA
                    FreeEnvironmentStringsA
                    HeapAlloc
                    GetCurrentProcess
                    GetEnvironmentStrings
                    GetCPInfo
                    UnhandledExceptionFilter
                    MultiByteToWideChar
                    FreeEnvironmentStringsW
                    GetCommandLineA
                    GetProcAddress
                    WideCharToMultiByte
                    GetStringTypeA
                    GetModuleHandleA
                    WriteFile
                    GetStartupInfoA
                    GetACP
                    HeapReAlloc
                    GetStringTypeW
                    TerminateProcess
                    CreateProcessA
                    QueryPerformanceCounter
                    GetEnvironmentVariableA
                    HeapCreate
                    VirtualFree
                    Sleep
                    GetFileType
                    GetTickCount
                    GetVersion
                    VirtualAlloc
                SHELL32.dll
                    ShellExecuteA
                WS2_32.dll
                    WSAStartup
                    gethostbyname
                    htons
                    WSASocketA
                    connect

        # strings.exe (Only part of the results)
            /,@
            cmd
            cmd.exe
            >> NUL
            /c del

    Dynamic Analysis
        Similar to Lab09-02.exe

        # IDA Pro & OllyDbg                 // Clock check
            QueryPerformanceCounter
                int __cdecl sub_4011E0(int a1)
                {
                int result; // eax
                signed int i; // [esp+Ch] [ebp-11Ch]
                char v3; // [esp+10h] [ebp-118h]
                LARGE_INTEGER v4; // [esp+18h] [ebp-110h]
                char v5; // [esp+20h] [ebp-108h]
                char v6; // [esp+21h] [ebp-107h]
                __int16 v7; // [esp+11Dh] [ebp-Bh]
                char v8; // [esp+11Fh] [ebp-9h]
                LARGE_INTEGER PerformanceCount; // [esp+120h] [ebp-8h]

                v3 = 1;
                v5 = 0;
                memset(&v6, 0, 0xFCu);
                v7 = 0;
                v8 = 0;
                QueryPerformanceCounter(&PerformanceCount);
                result = QueryPerformanceCounter(&v4);
                if ( (signed int)(v4.LowPart - PerformanceCount.LowPart) > 1200 )
                    v3 = 2;
                for ( i = 0; i < 3; ++i )
                {
                    *(_BYTE *)(i + a1) += v3 * (i + 1);
                    result = i + 1;
                }
                return result;
                }

            GetTickCount
                v16 = GetTickCount();
                sub_401000(v5, v6);
                v14 = GetTickCount();
                if ( v14 - v16 <= 1 )
            
            rdtsc
                int __cdecl sub_401300(const char *a1, int a2, int a3)
                {
                unsigned int v3; // kr04_4
                unsigned __int64 v4; // rax
                __int64 v5; // ST08_8
                unsigned int v6; // ST24_4
                unsigned __int64 v7; // rax
                signed int i; // [esp+14h] [ebp-Ch]

                v3 = strlen(a1) + 1;
                v4 = __rdtsc();
                v5 = (unsigned int)v4;
                v7 = __rdtsc();
                v6 = v7 - v5;
                LODWORD(v7) = HIDWORD(v5);
                if ( v6 > 0x7A120 )
                    sub_4010E0(12, HIDWORD(v7));
                for ( i = 0; i < 28; ++i )
                {
                    *(_BYTE *)(i + a3) = a1[i % (signed int)(v3 - 1)] ^ *(_BYTE *)(i + a2);
                    LODWORD(v7) = i + 1;
                }
                return v7;
                }