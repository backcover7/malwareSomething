Lab10-01.exe
    PE Analysis
        # Virustotal
            23/69
            SHA-256: e55cfa92acc2fac8b3b41002ebbef343bfdb61abf876e9c713f323e143d5e451

            PEiD packer
                Microsoft Visual C++

            TimeStamp: 2011-03-11 10:55:44

            Subsystem: Windows GUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	10510	12288	5.95	4a6e3b2d1dcc4cd759f4c8d630a4857e
                .rdata	16384	2014	4096	3.19	5b2c06febf5c16970b4bc7c2ade17f01
                .data	20480	2716	4096	0.98	0e5cf6bf4967e03bf22235a2e165151a
                .rsrc	24576	2448	4096	1.82	5045c8f96eac20bbe7e2b7f2a9270140

            IMPORT
                ADVAPI32.dll
                    CreateServiceA
                    OpenSCManagerA
                    StartServiceA
                    ControlService
                    OpenServiceA
                KERNEL32.DLL
                    HeapFree
                    GetStdHandle
                    LCMapStringW
                    SetHandleCount
                    GetOEMCP
                    LCMapStringA
                    HeapDestroy
                    ExitProcess
                    GetEnvironmentStringsW
                    GetModuleFileNameA
                    RtlUnwind
                    LoadLibraryA
                    FreeEnvironmentStringsA
                    GetStartupInfoA
                    GetEnvironmentStrings
                    GetCPInfo
                    UnhandledExceptionFilter
                    MultiByteToWideChar
                    FreeEnvironmentStringsW
                    GetCommandLineA
                    GetProcAddress
                    WideCharToMultiByte
                    GetStringTypeA
                    GetModuleHandleA
                    WriteFile
                    GetCurrentProcess
                    GetACP
                    HeapReAlloc
                    GetStringTypeW
                    TerminateProcess
                    HeapCreate
                    VirtualFree
                    GetFileType
                    HeapAlloc
                    GetVersion
                    VirtualAlloc

        # strings.exe (Only part of the results)
            Lab10-01
            C:\Windows\System32\Lab10-01.sys
            Hello World!

        # Resource Hacker
            Nothing valuable

    Dynamic Analysis
        # RegShot (Part of results)
            ----------------------------------
            Keys added:15
            ----------------------------------
            HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall
            HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
            HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\Control
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Security
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Enum
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\Control
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Security
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Enum

            ----------------------------------
            Values added:40
            ----------------------------------
            HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile\EnableFirewall: 0x00000000
            HKLM\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile\EnableFirewall: 0x00000000
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\Control\*NewlyCreated*: 0x00000000
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\Control\ActiveService: "Lab10-01"
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\Service: "Lab10-01"
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\Legacy: 0x00000001
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\ConfigFlags: 0x00000000
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\Class: "LegacyDriver"
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\ClassGUID: "{8ECC055D-047F-11D1-A537-0000F8753ED1}"
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\0000\DeviceDesc: "Lab10-01"
            HKLM\SYSTEM\ControlSet001\Enum\Root\LEGACY_LAB10-01\NextInstance: 0x00000001
            HKLM\SYSTEM\ControlSet001\Services\kmixer\Enum\0: "SW\{b7eafdc0-a680-11d0-96d8-00aa0051e51d}\{9B365890-165F-11D0-A195-0020AFD156E4}"
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Enum\0: "Root\LEGACY_LAB10-01\0000"
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Enum\Count: 0x00000001
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Enum\NextInstance: 0x00000001
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Security\Security: 01 00 14 80 90 00 00 00 9C 00 00 00 14 00 00 00 30 00 00 00 02 00 1C 00 01 00 00 00 02 80 14 00 FF 01 0F 00 01 01 00 00 00 00 00 01 00 00 00 00 02 00 60 00 04 00 00 00 00 00 14 00 FD 01 02 00 01 01 00 00 00 00 00 05 12 00 00 00 00 00 18 00 FF 01 0F 00 01 02 00 00 00 00 00 05 20 00 00 00 20 02 00 00 00 00 14 00 8D 01 02 00 01 01 00 00 00 00 00 05 0B 00 00 00 00 00 18 00 FD 01 02 00 01 02 00 00 00 00 00 05 20 00 00 00 23 02 00 00 01 01 00 00 00 00 00 05 12 00 00 00 01 01 00 00 00 00 00 05 12 00 00 00
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Type: 0x00000001
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\Start: 0x00000003
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\ErrorControl: 0x00000001
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\ImagePath: "\??\C:\Windows\System32\Lab10-01.sys"
            HKLM\SYSTEM\ControlSet001\Services\Lab10-01\DisplayName: "Lab10-01"
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\Control\*NewlyCreated*: 0x00000000
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\Control\ActiveService: "Lab10-01"
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\Service: "Lab10-01"
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\Legacy: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\ConfigFlags: 0x00000000
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\Class: "LegacyDriver"
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\ClassGUID: "{8ECC055D-047F-11D1-A537-0000F8753ED1}"
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\0000\DeviceDesc: "Lab10-01"
            HKLM\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_LAB10-01\NextInstance: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\kmixer\Enum\0: "SW\{b7eafdc0-a680-11d0-96d8-00aa0051e51d}\{9B365890-165F-11D0-A195-0020AFD156E4}"
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Enum\0: "Root\LEGACY_LAB10-01\0000"
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Enum\Count: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Enum\NextInstance: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Security\Security: 01 00 14 80 90 00 00 00 9C 00 00 00 14 00 00 00 30 00 00 00 02 00 1C 00 01 00 00 00 02 80 14 00 FF 01 0F 00 01 01 00 00 00 00 00 01 00 00 00 00 02 00 60 00 04 00 00 00 00 00 14 00 FD 01 02 00 01 01 00 00 00 00 00 05 12 00 00 00 00 00 18 00 FF 01 0F 00 01 02 00 00 00 00 00 05 20 00 00 00 20 02 00 00 00 00 14 00 8D 01 02 00 01 01 00 00 00 00 00 05 0B 00 00 00 00 00 18 00 FD 01 02 00 01 02 00 00 00 00 00 05 20 00 00 00 23 02 00 00 01 01 00 00 00 00 00 05 12 00 00 00 01 01 00 00 00 00 00 05 12 00 00 00
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Type: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\Start: 0x00000003
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\ErrorControl: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\ImagePath: "\??\C:\Windows\System32\Lab10-01.sys"
            HKLM\SYSTEM\CurrentControlSet\Services\Lab10-01\DisplayName: "Lab10-01"

            ----------------------------------
            Values modified:5
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: F5 B7 11 46 FB EE F2 A4 7A 69 19 C3 DE FF C1 73 C1 3D 4B 4F E0 DB 71 95 E1 25 13 95 33 40 F1 46 D0 37 8D 49 F7 7D 40 BC E4 72 90 03 AF A3 0E B9 0C C9 51 97 69 F9 1E 83 55 3E 66 D4 92 BC 28 B1 66 4E 43 65 B5 D7 F8 66 01 94 96 AC A8 DF 7D 8E
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 03 6E E3 0D 6F 02 C9 A2 C5 DB 55 2D 86 32 A9 D1 FB 86 99 F6 8D CF 46 E2 89 67 8D F8 97 24 60 24 C7 A6 01 88 27 A5 BD 1D 27 43 D1 A4 99 30 C4 77 34 DC 61 A6 4D 42 26 AC BB 3A 53 12 96 B9 74 5C AD B9 7E 1E 1E EF 22 A1 89 64 30 75 EA 96 56 C5
            HKLM\SYSTEM\ControlSet001\Services\kmixer\Enum\Count: 0x00000000
            HKLM\SYSTEM\ControlSet001\Services\kmixer\Enum\Count: 0x00000001
            HKLM\SYSTEM\ControlSet001\Services\kmixer\Enum\NextInstance: 0x00000000
            HKLM\SYSTEM\ControlSet001\Services\kmixer\Enum\NextInstance: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\kmixer\Enum\Count: 0x00000000
            HKLM\SYSTEM\CurrentControlSet\Services\kmixer\Enum\Count: 0x00000001
            HKLM\SYSTEM\CurrentControlSet\Services\kmixer\Enum\NextInstance: 0x00000000
            HKLM\SYSTEM\CurrentControlSet\Services\kmixer\Enum\NextInstance: 0x00000001

        # procexp (View > Lower Pane View > DLLS / Handles)
            NULL

        # procmon                                                   // Lab10-01.exe does not update registry directly through comparing the results of procmon and regshot.
            Filter
                Process Name is Lab10-01.exe Include
                Operation is RegSetValue Include
                Path ends with sys Include
            
            Result
                4:05:03.6832130 PM	Lab10-01.exe	2412	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 1C 48 81 0E 68 80 E1 80 1E D6 89 D3 BB 3C E3 93
                4:05:09.9874308 PM	Lab10-01.exe	2444	RegSetValue	HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed	SUCCESS	Type: REG_BINARY, Length: 80, Data: 03 6E E3 0D 6F 02 C9 A2 C5 DB 55 2D 86 32 A9 D1
                4:05:09.9760637 PM	Lab10-01.exe	2444	CreateFileMapping	C:\WINDOWS\system32\Lab10-01.sys	SUCCESS	SyncType: SyncTypeCreateSection, PageProtection: PAGE_READWRITE

        # autoruns
            Drivers
                HKLM\System\CurrentControlSet\Services				4/22/2020 11:10 AM
                    Lab10-01	Important System Driver	Windows (R) Win 7 DDK provider	c:\windows\system32\lab10-01.sys	1/14/2012 2:13 AM

        # ApateDNS
            NULL

        # IDA Pro & OllyDbg & WinDbg
            int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
            {
            result = (int)OpenSCManagerA(0, 0, 0xF003Fu);
            v5 = (void *)result;
            if ( result )
            {
                v6 = CreateServiceA(
                    (SC_HANDLE)result,
                    Lab10_01_Service,
                    Lab10_01_Service,
                    0xF01FFu,
                    1u,                                 // dwServiceType = 0x1 -> Create Kernel Driver
                    3u,                                 // dwStartType = 0x3 -> SERVICE_KERNEL_DRIVER
                    1u,
                    Lab10_01_sys,
                    0,
                    0,
                    0,
                    0,
                    0);
                if ( v6 || (v6 = OpenServiceA(v5, Lab10_01_Service, 0xF01FFu)) != 0 )
                {
                StartServiceA(v6, 0, 0);
                if ( v6 )
                    ControlService(v6, 1u, &ServiceStatus);             // 0x01 -> SERVICE_CONTROL_STOP
                }
                result = 0;
            }
            return result;
            }

            .text:00401080                 call    ds:ControlService

            Ollydbg > F2 00401080 > F9
            
            Windbg > Ctrl + Fn + B
                kd> !drvobj Lab10-01
                Driver object (86598c08) is for:            // Get address of driver object
                \Driver\Lab10-01

                kd> dt _DRIVER_OBJECT 86598c08
                nt!_DRIVER_OBJECT
                +0x000 Type             : 0n4
                +0x002 Size             : 0n168
                +0x004 DeviceObject     : (null) 
                +0x008 Flags            : 0x12
                +0x00c DriverStart      : 0xf7e7f000 Void
                +0x010 DriverSize       : 0xe80
                +0x014 DriverSection    : 0x866d0ed8 Void
                +0x018 DriverExtension  : 0x86598cb0 _DRIVER_EXTENSION
                +0x01c DriverName       : _UNICODE_STRING "\Driver\Lab10-01"
                +0x024 HardwareDatabase : 0x80690b90 _UNICODE_STRING "\REGISTRY\MACHINE\HARDWARE\DESCRIPTION\SYSTEM"
                +0x028 FastIoDispatch   : (null) 
                +0x02c DriverInit       : 0xf7e7f959     long  +0
                +0x030 DriverStartIo    : (null) 
                +0x034 DriverUnload     : 0xf7e7f486     void  +0                                       // DriverUnload 0xf7e7f486
                +0x038 MajorFunction    : [28] 0x804fd101     long  nt!IopInvalidDeviceRequest+0

                bp 0xf7e7f486 > g > OD F9

                kd> g
                Break instruction exception - code 80000003 (first chance)
                Lab10_01+0x486:
                f7e7f486 8bff            mov     edi,edi
                kd> p                                                                                   // Step over
                Lab10_01+0x488:
                f7e7f488 55              push    ebp
                kd> p
                Lab10_01+0x489:
                f7e7f489 8bec            mov     ebp,esp
                kd> p
                Lab10_01+0x48b:
                f7e7f48b 51              push    ecx
                kd> p
                Lab10_01+0x48c:
                f7e7f48c 53              push    ebx
                kd> p
                Lab10_01+0x48d:
                f7e7f48d 56              push    esi
                kd> p
                Lab10_01+0x48e:
                f7e7f48e 8b3580f7e7f7    mov     esi,dword ptr [Lab10_01+0x780 (f7e7f780)]
                kd> p
                Lab10_01+0x494:
                f7e7f494 57              push    edi
                kd> p
                Lab10_01+0x495:
                f7e7f495 33ff            xor     edi,edi
                kd> p
                Lab10_01+0x497:
                f7e7f497 68bcf6e7f7      push    offset Lab10_01+0x6bc (f7e7f6bc)                       // arg
                kd> p
                Lab10_01+0x49c:
                f7e7f49c 57              push    edi                                                    // arg
                kd> p
                Lab10_01+0x49d:
                f7e7f49d 897dfc          mov     dword ptr [ebp-4],edi
                kd> p
                Lab10_01+0x4a0:
                f7e7f4a0 ffd6            call    esi
                kd> u esi                                                                               // view call: NTSTATUS RtlCreateRegistryKey(_In_ ULONG RelativeTo, _In_ PWSTR Path);
                nt!RtlCreateRegistryKey:
                805b67c8 8bff            mov     edi,edi
                805b67ca 55              push    ebp
                805b67cb 8bec            mov     ebp,esp
                805b67cd 8d450c          lea     eax,[ebp+0Ch]
                805b67d0 50              push    eax
                805b67d1 6a01            push    1
                805b67d3 ff750c          push    dword ptr [ebp+0Ch]
                805b67d6 ff7508          push    dword ptr [ebp+8]
                kd> dc f7e7f6bc                                                                         // Path
                f7e7f6bc  0052005c 00670065 00730069 00720074  \.R.e.g.i.s.t.r.
                f7e7f6cc  005c0079 0061004d 00680063 006e0069  y.\.M.a.c.h.i.n.
                f7e7f6dc  005c0065 004f0053 00540046 00410057  e.\.S.O.F.T.W.A.
                f7e7f6ec  00450052 0050005c 006c006f 00630069  R.E.\.P.o.l.i.c.
                f7e7f6fc  00650069 005c0073 0069004d 00720063  i.e.s.\.M.i.c.r.
                f7e7f70c  0073006f 0066006f 00000074 00000000  o.s.o.f.t.......
                f7e7f71c  00000000 00000000 00000000 00000000  ................
                f7e7f72c  00000000 00000000 00000000 00000000  ................
                kd> r edi                                                                               // RelativeTo: 0
                edi=00000000
                kd> p
                Lab10_01+0x4a2:
                f7e7f4a2 6840f6e7f7      push    offset Lab10_01+0x640 (f7e7f640)
                kd> p
                Lab10_01+0x4a7:
                f7e7f4a7 57              push    edi
                kd> p
                Lab10_01+0x4a8:
                f7e7f4a8 ffd6            call    esi
                kd> u esi
                nt!RtlCreateRegistryKey:
                805b67c8 8bff            mov     edi,edi
                805b67ca 55              push    ebp
                805b67cb 8bec            mov     ebp,esp
                805b67cd 8d450c          lea     eax,[ebp+0Ch]
                805b67d0 50              push    eax
                805b67d1 6a01            push    1
                805b67d3 ff750c          push    dword ptr [ebp+0Ch]
                805b67d6 ff7508          push    dword ptr [ebp+8]
                kd> r edi
                edi=00000000
                kd> dc f7e7f640
                ReadVirtual: f7e7f640 not properly sign extended
                f7e7f640  0052005c 00670065 00730069 00720074  \.R.e.g.i.s.t.r.
                f7e7f650  005c0079 0061004d 00680063 006e0069  y.\.M.a.c.h.i.n.
                f7e7f660  005c0065 004f0053 00540046 00410057  e.\.S.O.F.T.W.A.
                f7e7f670  00450052 0050005c 006c006f 00630069  R.E.\.P.o.l.i.c.
                f7e7f680  00650069 005c0073 0069004d 00720063  i.e.s.\.M.i.c.r.
                f7e7f690  0073006f 0066006f 005c0074 00690057  o.s.o.f.t.\.W.i.
                f7e7f6a0  0064006e 0077006f 00460073 00720069  n.d.o.w.s.F.i.r.
                f7e7f6b0  00770065 006c0061 0000006c 0052005c  e.w.a.l.l...\.R.                         // \00

                \Registry\Machine\SOFTWARE\Policies\Microsoft
                \Registry\Machine\SOFTWARE\Policies\Microsoft\WindowsFirewall
                \Registry\Machine\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
                \Registry\Machine\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile

                ...
                kd> u esi
                nt!RtlWriteRegistryValue:
                805b08a1 8bff            mov     edi,edi
                805b08a3 55              push    ebp
                805b08a4 8bec            mov     ebp,esp
                805b08a6 51              push    ecx
                805b08a7 51              push    ecx
                805b08a8 8d450c          lea     eax,[ebp+0Ch]
                805b08ab 50              push    eax
                805b08ac 6a01            push    1
                kd> r edi
                edi=f7e7f4ee
                kd> dc f7e7f4ee
                ReadVirtual: f7e7f4ee not properly sign extended
                f7e7f4ee  006e0045 00620061 0065006c 00690046  E.n.a.b.l.e.F.i.
                f7e7f4fe  00650072 00610077 006c006c 005c0000  r.e.w.a.l.l...\.
                f7e7f50e  00650052 00690067 00740073 00790072  R.e.g.i.s.t.r.y.
                f7e7f51e  004d005c 00630061 00690068 0065006e  \.M.a.c.h.i.n.e.
                f7e7f52e  0053005c 0046004f 00570054 00520041  \.S.O.F.T.W.A.R.
                f7e7f53e  005c0045 006f0050 0069006c 00690063  E.\.P.o.l.i.c.i.
                f7e7f54e  00730065 004d005c 00630069 006f0072  e.s.\.M.i.c.r.o.
                f7e7f55e  006f0073 00740066 0057005c 006e0069  s.o.f.t.\.W.i.n.
                kd> r eax
                eax=f7c92d54
                kd> dc f7c92d54
                ReadVirtual: f7c92d54 not properly sign extended
                f7c92d54  00000000 f7c92d74 805e7dbe 86598c08  ....t-...}^...Y.                         // 00000000 <- EnableFirewall
                kd> p
                Lab10_01+0x4e6:
                f7e7f4e6 5f              pop     edi
                kd> p
                Lab10_01+0x4e7:
                f7e7f4e7 5e              pop     esi
                kd> p
                Lab10_01+0x4e8:
                f7e7f4e8 5b              pop     ebx
                kd> p
                Lab10_01+0x4e9:
                f7e7f4e9 c9              leave

Lab10-01.sys
    PE Analysis
        # Virustotal
            6/66
            SHA-256: d12a2c116a12993cfcf2f432a4fe53f8f6b3686e33ed8f7e8ff4628a37bd616e

            TimeStamp: 2012-01-14 09:13:34
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                    .text	1152	664	768	3.52	5db8b9032462b03465fe1d3600ea9bb7
                    .rdata	1920	152	256	3.61	062fd4883750cefcaf3446ed98ca2e6c
                    .data	2176	8	128	0.52	1f558917e0b83de44fffa4db41aab932
                    INIT	2304	240	256	4.76	89813866c353c25e1b21606853fa8644
                    .rsrc	2560	944	1024	3.25	31acb557ff793d8cabecaaf962499414
                    .reloc	3584	44	128	1.66	f24813e29cb0151fc9ab8e9dd9e5d919

            IMPORT
                ntoskrnl.exe
                    KeTickCount                 // All of the driver file .sys will import this function
                    RtlWriteRegistryValue       // Access registry
                    RtlCreateRegistryKey        // Access registry

        # strings.exe (Only part of the results)
            EnableFirewall                                                                          \\ Set EnableFirewall to 0 means disable XP firewall
            \Registry\Machine\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile           \\ Acess registry from the kernel
            \Registry\Machine\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile
            \Registry\Machine\SOFTWARE\Policies\Microsoft\WindowsFirewall
            \Registry\Machine\SOFTWARE\Policies\Microsoft
            c:\winddk\7600.16385.1\src\general\regwriter\wdm\sys\objfre_wxp_x86\i386\sioctl.pdb
            ntoskrnl.exe

        # Resource Hacker
            Nothing valuable

Analysis
    The malware update registry to disable Firewall by loading driver file.
