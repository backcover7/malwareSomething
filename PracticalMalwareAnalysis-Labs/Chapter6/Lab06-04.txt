Lab06-04.exe
    PE Analysis
        # Virustotal
            37/69
            SHA-256: cce96e5cb884c565c75960c41f53a7b56cef1a3ff5b9893cd81c390fd0c35ef3

        # PEid
            Microsoft Visual C++ 6.0

        # PEview
            TimeStamp (IMAGE_FILE_HEADER): 2011/02/04 Fri 00:38:24
            Subsystem (IMAGE_OPTIONAL_HEADER): IMAGE_SUBSYSTEM_WINDOWS_CUI (cmd)
            Sections (Virtual Size / Size of Raw Data) -> No Packed
                .text: 4BFA/5000
                .rdata: A00/1000
                .data: 3FC8/3000
        
        # Dependency Walker
            KERNEL32.DLL
                CloseHandle
                CopyFileA
                CreateDirectoryA
                DeleteFileA
                ExitProcess
                FlushFileBuffers
                FreeEnvironmentStringsA
                FreeEnvironmentStringsW
                GetACP
                GetCommandLineA
                GetCPInfo
                GetCurrentProcess
                GetEnvironmentStrings
                GetEnvironmentStringsW
                GetEnvironmentVariableA
                GetFileType
                GetLastError
                GetModuleFileNameA
                GetModuleHandleA
                GetOEMCP
                GetProcAddress
                GetStartupInfoA
                GetStdHandle
                GetStringTypeA
                GetStringTypeW
                GetVersion
                GetVersionExA
                HeapAlloc
                HeapCreate
                HeapDestroy
                HeapFree
                HeapReAlloc
                LCMapStringA
                LCMapStringW
                LoadLibraryA
                MultiByteToWideChar
                RtlUnwind
                SetFilePointer
                SetHandleCount
                SetStdHandle
                Sleep
                TerminateProcess
                UnhandledExceptionFilter
                VirtualAlloc
                VirtualFree
                WideCharToMultiByte
                WriteFile
            WININET.DLL
                InternetCloseHandle
                InternetGetConnectedState
                InternetOpenA
                InternetOpenUrlA
                InternetReadFile
            ADVAPI32.DLL
                RegOpenKeyExA
                RegSetValueExA

        # strings.exe (Only part of the results)
            Error 1.1: No Internet
            Success: Internet Connection
            Error 2.3: Fail to get command
            Error 2.2: Fail to ReadFile
            Error 2.1: Fail to OpenUrl
            http://www.practicalmalwareanalysis.com/cc.htm
            Internet Explorer 7.50/pma%d
            Error 3.2: Not a valid command provided
            Error 3.1: Could not set Registry value
            Malware
            Software\Microsoft\Windows\CurrentVersion\Run
            C:\Temp\cc.exe
            C:\Temp
            Success: Parsed command is %c

    Dynamic Analysis
        C:\Documents and Settings\practice\Desktop>Lab06-04.exe
        Success: Internet Connection
        Error 2.3: Fail to get command

        # RegShot (Part of results)
            ----------------------------------
            Values modified:3
            ----------------------------------
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 42 73 DF B1 A0 80 29 D5 EA 33 FA D9 61 71 B0 A8 F8 23 18 A6 58 EE 11 F4 C4 BE 4F DE EE 00 36 E3 1C 3E 7A F3 B7 2B 85 CE 5D 95 24 EC 50 C1 9A BC 66 62 A0 3C E0 73 60 A9 96 2A A3 B6 6B B8 7D 42 56 D8 69 A1 9F C2 7C 79 55 E8 22 12 45 F0 B6 DD
            HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: E0 C5 66 E2 59 2C D5 D2 B1 B9 3B FF E5 9F 82 F9 E8 83 09 CF E4 A5 3F 86 0D E1 67 EA 80 2E 21 09 C8 EC 19 AF 24 62 F0 6F EB B6 F7 A3 0C A1 3B CC 2A F2 C9 CA 63 D7 CC 1C 41 40 3A 31 5E E0 2D 63 17 F2 90 AD 4C EB 51 BB D7 18 1F B4 76 BB FE 1C
            HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections\SavedLegacySettings: 46 00 00 00 12 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 C0 54 DE 4C 9C 19 D6 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 0A 00 00 02 00 00 00 00 00 00 00 00 01 00 00 00 05 00 00 00 08 B8 16 00 60 35 18 00 00 00 00 00 10 01 00 00 FF FF FF FF 00 00 00 00 0C 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 A8 02 00 00 00 00 00 C0 00 00 00 00 00 00 46 40 9D 05 22 9E 7E CF 11 AE 5A 00 AA 00 A7 11 2B 6D 00 61 00 6C 00 77 00 61 00 72 00 65 00 00 00 00 00 00 00
            HKU\S-1-5-21-1078081533-842925246-1708537768-1003\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections\SavedLegacySettings: 46 00 00 00 14 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 C0 54 DE 4C 9C 19 D6 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 0A 00 00 02 00 00 00 00 00 00 00 00 01 00 00 00 05 00 00 00 08 B8 16 00 60 35 18 00 00 00 00 00 10 01 00 00 FF FF FF FF 00 00 00 00 0C 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 A8 02 00 00 00 00 00 C0 00 00 00 00 00 00 46 40 9D 05 22 9E 7E CF 11 AE 5A 00 AA 00 A7 11 2B 6D 00 61 00 6C 00 77 00 61 00 72 00 65 00 00 00 00 00 00 00
            HKU\S-1-5-21-1078081533-842925246-1708537768-1003\SessionInformation\ProgramCount: 0x00000004
            HKU\S-1-5-21-1078081533-842925246-1708537768-1003\SessionInformation\ProgramCount: 0x00000005

        # procexp (View > Lower Pane View > DLLS / Handles)
            NULL

        # procmon
            Filter
                Proces Name is Lab06-04.exe Include
                Operation is RegSetValue Include
                Operation is WriteFile Include
            Result
                2:52:30.5142299 PM	Lab06-04.exe	3644	CreateFile	C:\Documents and Settings\practice\Local Settings\Temporary Internet Files\Content.IE5\B325A768\cc[1].htm	SUCCESS	Desired Access: Generic Write, Read Attributes, Disposition: Create, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: NCI, ShareMode: Read, Write, Delete, AllocationSize: 0, OpenResult: Created


        # ApateDNS
            www.practicalmalwareanalysis.com
            33 CF 01 00 00 01 00 00  00 00 00 00 03 77 77 77            3Ï···········www
            18 70 72 61 63 74 69 63  61 6C 6D 61 6C 77 61 72            ·practicalmalwar
            65 61 6E 61 6C 79 73 69  73 03 63 6F 6D 00 00 01            eanalysis·com···
            00 01 00 00                                                 ···· 

        # INetSim
            2020-04-26 17:46:14  First simulated date in log file
            2020-04-26 17:46:14  HTTP connection, method: GET, URL: http://www.practicalmalwareanalysis.com/cc.htm, file name: /var/lib/inetsim/http/fakefiles/sample.html
            2020-04-26 17:46:14  Last simulated date in log file
        
        # IDA Pro
            Lab06-04.exe add a loop structure. The functionality is basically the same.

            sub_401040 (HTML parse function) has a arg in Lab06-04.exe
                char __cdecl sub_401040(int a1)
                {
                sprintf(&szAgent, aInternetExplor, a1);                 // count of loop
                hInternet = InternetOpenA(&szAgent, 0, 0, 0, 0);        // UserAgent will change each loop > Also, we can confirm the time delay through the HTTP header field

            It will stay running about 1min * 1440 = 24h = 1day
